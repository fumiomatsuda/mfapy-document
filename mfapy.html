
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>mfapy package &#8212; mfapy  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to mfapy’s documentation!" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="mfapy-package">
<h1>mfapy package<a class="headerlink" href="#mfapy-package" title="Permalink to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-mfapy.carbonsource">
<span id="mfapy-carbonsource-module"></span><h2>mfapy.carbonsource module<a class="headerlink" href="#module-mfapy.carbonsource" title="Permalink to this heading">¶</a></h2>
<p>carbonsource.py:CarbonSource class in mfapy</p>
<p>The module includes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CarbonSource</span> <span class="k">class</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Subtraction of natural isotope</p></li>
</ul>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="mfapy.carbonsource.CarbonSource">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mfapy.carbonsource.</span></span><span class="sig-name descname"><span class="pre">CarbonSource</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">carbon_sources</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emu_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.carbonsource.CarbonSource" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for carbon source information.</p>
<p>Instance of this class is generated in the MetabolicModel instance</p>
<dl class="py method">
<dt class="sig sig-object py" id="mfapy.carbonsource.CarbonSource.generate_carbonsource_MDV">
<span class="sig-name descname"><span class="pre">generate_carbonsource_MDV</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">carbonsource</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'no'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.carbonsource.CarbonSource.generate_carbonsource_MDV" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator of MDVs of all EMUs of each carbon source.</p>
<p>This function is called in the mfapy.metabolicmodel.MetabolicModel</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>carbonsource</strong> (<em>array</em>) – List of carbon source metabolite (optional)</p></li>
<li><p><strong>correction</strong> (<em>str</em>) – (yes/no) Correction of isotopomer distribution considering natural 13C occurence</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of mdv data of carbon source.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cs</span><span class="o">.</span><span class="n">generate_carbonsource_MDV</span><span class="p">()</span>
</pre></div>
</div>
<p>History:</p>
<blockquote>
<div><p>Correcton of IDV by natural 13C method was improved.</p>
<p>labeled by 2 13C and 3 13C was taken into consideration.</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.carbonsource.CarbonSource.generate_dict">
<span class="sig-name descname"><span class="pre">generate_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.carbonsource.CarbonSource.generate_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator of a dictionary of MDVs of all EMUs of carbon sources</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>required.</strong> (<em>Not</em>) – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of MDVs of all EMUs of carbon sources</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mdvs</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">generate_dict</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.carbonsource.CarbonSource.set_all_isotopomers">
<span class="sig-name descname"><span class="pre">set_all_isotopomers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'no'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.carbonsource.CarbonSource.set_all_isotopomers" title="Permalink to this definition">¶</a></dt>
<dd><p>Setter of IDV data by list of all mass isotopomer distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>compound</strong> (<em>str</em>) – Name of carbon source.</p></li>
<li><p><strong>list</strong> (<em>array</em>) – list of mass isotopomer distribution (from 000, 001, 010, to 111)</p></li>
<li><p><strong>correction</strong> (<em>str</em>) – (yes/no) Correction of isotopomer distribution considering natural 13C occurence</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True/False</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Booleans</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cs</span><span class="o">.</span><span class="n">set_all_isotopomers</span><span class="p">(</span><span class="s1">&#39;AcCoA&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.carbonsource.CarbonSource.set_carbonsources">
<span class="sig-name descname"><span class="pre">set_carbonsources</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'no'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'text'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.carbonsource.CarbonSource.set_carbonsources" title="Permalink to this definition">¶</a></dt>
<dd><p>Setter of isotopomer data of multiple carbon sourses from text file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – <p>filename of MDV data with following format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Name</span>    <span class="n">Isotopomer</span>      <span class="n">Ratio</span>
<span class="n">Asp</span>     <span class="c1">#0000   0.5</span>
<span class="n">Asp</span>     <span class="c1">#1111   0.5</span>
<span class="n">AcCoA</span>   <span class="c1">#00     0.5</span>
<span class="n">AcCoA</span>   <span class="c1">#11     0.5</span>
</pre></div>
</div>
</p></li>
<li><p><strong>correction</strong> (<em>str</em>) – (yes/no) Correction of isotopomer distribution considering natural 13C occurence</p></li>
<li><p><strong>format</strong> (<em>str</em>) – “text” (defalut) or “csv”</p></li>
<li><p><strong>output</strong> (<em>str</em>) – “normal” (defalut) or “debug”</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True/False</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Boolean</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cs2</span><span class="o">.</span><span class="n">set_isotopomers_from_file</span><span class="p">(</span><span class="s1">&#39;Example_1_carbonsource2.txt&#39;</span><span class="p">,</span> <span class="n">correction</span> <span class="o">=</span> <span class="s2">&quot;yes&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.carbonsource.CarbonSource.set_each_isotopomer">
<span class="sig-name descname"><span class="pre">set_each_isotopomer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'no'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.carbonsource.CarbonSource.set_each_isotopomer" title="Permalink to this definition">¶</a></dt>
<dd><p>Setter of IDV data of selected mass isotopomers</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>compound</strong> (<em>str</em>) – Name of carbon source</p></li>
<li><p><strong>dict</strong> (<em>dict</em>) – <p>Dictionary of mass isotopomer and its relative abundance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;#111&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;#001&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">}</span>
</pre></div>
</div>
</p></li>
<li><p><strong>correction</strong> (<em>str</em>) – (yes/no) Correction of isotopomer distribution considering natural 13C occurence</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True/False</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Boolean</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cs</span><span class="o">.</span><span class="n">set_each_isotopomers</span><span class="p">(</span><span class="s1">&#39;AcCoA&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;#11&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;#10&#39;</span><span class="p">:</span><span class="mf">0.25</span><span class="p">},</span> <span class="n">correction</span> <span class="o">=</span> <span class="s1">&#39;yes&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.carbonsource.CarbonSource.set_labeled_compounds">
<span class="sig-name descname"><span class="pre">set_labeled_compounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'no'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.carbonsource.CarbonSource.set_labeled_compounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Setter of IDV data by distribution of selected mass isotopomers</p>
<p>Following symbols are available:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;[13C]CO2&quot;</span><span class="p">:</span> <span class="s2">&quot;#1&quot;</span><span class="p">,</span>
<span class="s2">&quot;[12C]CO2&quot;</span><span class="p">:</span> <span class="s2">&quot;#0&quot;</span><span class="p">,</span>
<span class="s2">&quot;[13C]THF&quot;</span><span class="p">:</span> <span class="s2">&quot;#1&quot;</span><span class="p">,</span>
<span class="s2">&quot;[12C]THF&quot;</span><span class="p">:</span> <span class="s2">&quot;#0&quot;</span><span class="p">,</span>
<span class="s2">&quot;[1-13C]glucose&quot;</span><span class="p">:</span> <span class="s2">&quot;#100000&quot;</span><span class="p">,</span>
<span class="s2">&quot;[2-13C]glucose&quot;</span><span class="p">:</span> <span class="s2">&quot;#010000&quot;</span><span class="p">,</span>
<span class="s2">&quot;[1,2-13C]glucose&quot;</span><span class="p">:</span> <span class="s2">&quot;#110000&quot;</span><span class="p">,</span>
<span class="s2">&quot;[U-13C]glucose&quot;</span><span class="p">:</span> <span class="s2">&quot;#111111&quot;</span><span class="p">,</span>
<span class="s2">&quot;[1-13C]glutamine&quot;</span><span class="p">:</span> <span class="s2">&quot;#10000&quot;</span><span class="p">,</span>
<span class="s2">&quot;[2-13C]glutamine&quot;</span><span class="p">:</span> <span class="s2">&quot;#01000&quot;</span><span class="p">,</span>
<span class="s2">&quot;[5-13C]glutamine&quot;</span><span class="p">:</span> <span class="s2">&quot;#00001&quot;</span><span class="p">,</span>
<span class="s2">&quot;[U-13C]glutamine&quot;</span><span class="p">:</span> <span class="s2">&quot;#11111&quot;</span><span class="p">,</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>compound</strong> (<em>str</em>) – Name of carbon source.</p></li>
<li><p><strong>dict</strong> (<em>dict</em>) – Dictionary of mass isotopomer and its relative abundance {‘#111’: 0.5, ‘#001’: 0.5}</p></li>
<li><p><strong>correction</strong> (<em>str</em>) – (yes/no) Correction of isotopomer distribution considering natural 13C occurence</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True/False</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Boolean</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cs</span><span class="o">.</span><span class="n">set_labeled_compounds</span><span class="p">(</span><span class="s1">&#39;Glc&#39;</span><span class="p">,{</span><span class="s1">&#39;[1_13C]glucose&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;[U_13C]glucose&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">},</span> <span class="n">correction</span> <span class="o">=</span> <span class="s1">&#39;yes&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.carbonsource.CarbonSource.show">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.carbonsource.CarbonSource.show" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to display contents of CarbonSource instance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>required.</strong> (<em>Not</em>) – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nothing.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cs</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">Name: Asp</span>
<span class="go">Carbon number: 4</span>
<span class="go">#0000       1.0</span>
<span class="go">Name: AcCoA</span>
<span class="go">Carbon number: 2</span>
<span class="go">#00 0.5</span>
<span class="go">#10 0.25</span>
<span class="go">#11 0.25</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfapy.carbonsource.main">
<span class="sig-prename descclassname"><span class="pre">mfapy.carbonsource.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.carbonsource.main" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-mfapy.mdv">
<span id="mfapy-mdv-module"></span><h2>mfapy.mdv module<a class="headerlink" href="#module-mfapy.mdv" title="Permalink to this heading">¶</a></h2>
<p>mdv.py:MdvData class in mfapy</p>
<p>The module includes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MdvData</span> <span class="k">class</span>
<span class="nc">MdvTimeCourseData</span> <span class="k">class</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>I/O</p></li>
</ul>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="mfapy.mdv.INV_correcting">
<span class="sig-prename descclassname"><span class="pre">mfapy.mdv.</span></span><span class="sig-name descname"><span class="pre">INV_correcting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">formula</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.INV_correcting" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mfapy.mdv.MdvData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mfapy.mdv.</span></span><span class="sig-name descname"><span class="pre">MdvData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_fragments</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class of mass distribution vector (MDV) information. A instance of the MdvData class could be generate from
an instance of MetabolicModel class using model.generate_mdv_templete()</p>
<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvData.add_gaussian_noise">
<span class="sig-name descname"><span class="pre">add_gaussian_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stdev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'absolute'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'on'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvData.add_gaussian_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Addition of gausian noise to MDV data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stdev</strong> (<em>float</em>) – noise level (standard deviation of normal distribution)</p></li>
<li><p><strong>iteration</strong> (<em>int</em>) – number of sampleing (experimental)</p></li>
<li><p><strong>method</strong> (<em>str</em>) – <p>method to add gausian noise</p>
<ul>
<li><p>”relative”  intentsity = (randn() * stdev + 1) * original_intensity</p></li>
<li><p>”absolute” (default) intentsity = randn() * stdev) + original_intensity</p></li>
</ul>
</p></li>
<li><p><strong>normalize</strong> (<em>str</em>) – on (default)/off sum of ratio is set to 1.0</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True/False</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>boolean</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mdv</span><span class="o">.</span><span class="n">add_gaussian_noise</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvData.add_natural_isotope">
<span class="sig-name descname"><span class="pre">add_natural_isotope</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvData.add_natural_isotope" title="Permalink to this definition">¶</a></dt>
<dd><p>Addition of natural isotope effect to fragments</p>
<p>Molecular formula information in “target fragment” of model file is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>required.</strong> (<em>Not</em>) – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nothing.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mdv</span><span class="o">.</span><span class="n">add_natural_isotope</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvData.check">
<span class="sig-name descname"><span class="pre">check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'debug'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvData.check" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to check missing values in the MDV data before MDV comparison</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>output</strong> (<em>str</em>) – Show details when “debug” mode</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True/False</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>boolean</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mdv</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvData.comparison_with_another_mdv">
<span class="sig-name descname"><span class="pre">comparison_with_another_mdv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdv</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvData.comparison_with_another_mdv" title="Permalink to this definition">¶</a></dt>
<dd><p>Comparison of two MDV data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mdv</strong> – instanse of another MdvData class for comparison</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nothing</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mdv</span><span class="o">.</span><span class="n">compare_mdv</span><span class="p">(</span><span class="n">mdv_fitted</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvData.correct_natural_isotope">
<span class="sig-name descname"><span class="pre">correct_natural_isotope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvData.correct_natural_isotope" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtraction of natural isotope effect from fragments</p>
<p>Molecular formula information of “target fragment” in the model definition file is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mode</strong> (<em>str</em>) – “normal”(defalut) and “correction” (forced removal of negatives value and sum(ratio) is set at 1.0)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nothing</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mdv</span><span class="o">.</span><span class="n">correct_natural_isotope</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvData.generate_observed_mdv">
<span class="sig-name descname"><span class="pre">generate_observed_mdv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvData.generate_observed_mdv" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator of MDV related inforamtion in list format.</p>
<p>This function is onely used in model.set_experiment()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>required.</strong> (<em>Nor</em>) – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>id_array (array) List of ids</p></li>
<li><p>ratio_array (array) List of ratio data</p></li>
<li><p>std_array (array) List of std data</p></li>
<li><p>use_array (array) List of use data</p></li>
<li><p>observed_fragments (array) List of observed fragments</p></li>
<li><p>data (array) List of other information</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">id_array</span><span class="p">,</span> <span class="n">ratio_array</span><span class="p">,</span> <span class="n">std_array</span><span class="p">,</span> <span class="n">use_array</span><span class="p">,</span> <span class="n">observed_fragments</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mdv</span><span class="o">.</span><span class="n">generate_observed_mdv</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvData.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fragment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvData.get_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Getter of [number] th isotopomer in the MDV of [fragment].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fragment</strong> (<em>str</em>) – name of target_fragment</p></li>
<li><p><strong>number</strong> (<em>int</em>) – [number] th isotopomer</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>ratio (float) Relative abundance of mass spectra data</p>
<p>std (float) Standard deviation of measured MDV data</p>
<p>use (str) Data to be used for MDV comparison. ‘use’ or ‘no’</p>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ratio</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">use</span> <span class="o">=</span> <span class="n">mdv</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s1">&#39;Leu85&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvData.get_fragment_mdv">
<span class="sig-name descname"><span class="pre">get_fragment_mdv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fragment</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvData.get_fragment_mdv" title="Permalink to this definition">¶</a></dt>
<dd><p>Getter of  MDV data of [fragment].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fragment</strong> (<em>str</em>) – name of target_fragment</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>mdv_pattern (array) Array of MDV of fragment</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mdv_pattern</span> <span class="o">=</span> <span class="n">mdv</span><span class="o">.</span><span class="n">get_fragment_mdv</span><span class="p">(</span><span class="s1">&#39;Leu85&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvData.get_fragments_for_mdv_calculation">
<span class="sig-name descname"><span class="pre">get_fragments_for_mdv_calculation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvData.get_fragments_for_mdv_calculation" title="Permalink to this definition">¶</a></dt>
<dd><p>Getter of fragment list whose MDVs are calculated in calmdv fucntion</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>required.</strong> (<em>Not</em>) – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of fragment names calculated in calmdv fucntion</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">list_of_fragment</span> <span class="o">=</span> <span class="n">mdv</span><span class="o">.</span><span class="n">get_fragments_for_mdv_calculation</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvData.get_number_of_measurement">
<span class="sig-name descname"><span class="pre">get_number_of_measurement</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvData.get_number_of_measurement" title="Permalink to this definition">¶</a></dt>
<dd><p>Getter of number of measurement of the MDV data set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>required.</strong> (<em>Nor</em>) – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of measurement</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">number_of_measurement</span> <span class="o">=</span> <span class="n">mdv</span><span class="o">.</span><span class="n">get_number_of_measurement</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvData.has_data">
<span class="sig-name descname"><span class="pre">has_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fragment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvData.has_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Checker whether the MdvData instance has data of [number] th isotopomer in the MDV of [fragment].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fragment</strong> (<em>str</em>) – name of target_fragment</p></li>
<li><p><strong>number</strong> (<em>int</em>) – [number] th isotopomer</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>TrueFalse</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Boolean</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">mdv</span><span class="o">.</span><span class="n">has_data</span><span class="p">(</span><span class="s1">&#39;Leu85&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="n">brabra</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvData.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'text'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvData.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to load MDV data from text/csv file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – <p>filename of MDV data with the format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Name</span>    <span class="n">Spectrum</span>        <span class="n">Select</span>  <span class="n">MDV</span>     <span class="n">Std</span>
<span class="n">Ala57</span>   <span class="n">m0</span>      <span class="mi">1</span>       <span class="mf">0.566990778</span>     <span class="mf">0.000774686</span>
<span class="n">Ala57</span>   <span class="n">m1</span>      <span class="mi">1</span>       <span class="mf">0.148623963</span>     <span class="mf">0.000774686</span>
<span class="n">Ala57</span>   <span class="n">m2</span>      <span class="mi">1</span>       <span class="mf">0.039467636</span>     <span class="mf">0.000774686</span>
<span class="n">Ala57</span>   <span class="n">m3</span>      <span class="mi">1</span>       <span class="mf">0.244917622</span>     <span class="mf">0.000774686</span>
</pre></div>
</div>
</p></li>
<li><p><strong>format</strong> (<em>str</em>) – <p>file format:</p>
<ul>
<li><p>’csv’ : CSV.</p></li>
<li><p>’text’ (defalut) : tab-deliminated text.</p></li>
</ul>
</p></li>
<li><p><strong>output</strong> – “normal” (defalut) or “debug”</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True/False</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Boolean</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mdv</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;filename&#39;</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;normal&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvData.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'text'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvData.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to save MDV data in text/csv file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – <p>filename of MDV data with the format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Name</span>    <span class="n">Spectrum</span>        <span class="n">Select</span>  <span class="n">MDV</span>     <span class="n">Std</span>
<span class="n">Ala57</span>   <span class="n">m0</span>      <span class="mi">1</span>       <span class="mf">0.566990778</span>     <span class="mf">0.000774686</span>
<span class="n">Ala57</span>   <span class="n">m1</span>      <span class="mi">1</span>       <span class="mf">0.148623963</span>     <span class="mf">0.000774686</span>
<span class="n">Ala57</span>   <span class="n">m2</span>      <span class="mi">1</span>       <span class="mf">0.039467636</span>     <span class="mf">0.000774686</span>
<span class="n">Ala57</span>   <span class="n">m3</span>      <span class="mi">1</span>       <span class="mf">0.244917622</span>     <span class="mf">0.000774686</span>
</pre></div>
</div>
</p></li>
<li><p><strong>format</strong> (<em>str</em>) – <p>file format:</p>
<ul>
<li><p>’csv’ : CSV.</p></li>
<li><p>’text’ (defalut) : tab-deliminated text.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True/False</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Boolean</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mdv</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;filename&#39;</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s2">&quot;csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvData.set_data">
<span class="sig-name descname"><span class="pre">set_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fragment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvData.set_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Setter of [number] th isotopomer in the MDV of [fragment].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fragment</strong> (<em>str</em>) – name of target_fragment</p></li>
<li><p><strong>number</strong> (<em>int</em>) – [number] th isotopomer</p></li>
<li><p><strong>ratio</strong> (<em>float</em>) – Relative abundance of mass spectra data</p></li>
<li><p><strong>std</strong> (<em>float</em>) – Standard deviation of measured MDV data</p></li>
<li><p><strong>use</strong> (<em>str</em>) – Data to be used for MDV comparison. ‘use’ or ‘no’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>TrueFalse</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Boolean</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mdv</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="s1">&#39;Leu85&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.763</span><span class="p">,</span> <span class="mf">0.0054</span><span class="p">,</span> <span class="s1">&#39;use&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvData.set_mdv_for_comparison">
<span class="sig-name descname"><span class="pre">set_mdv_for_comparison</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fragment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvData.set_mdv_for_comparison" title="Permalink to this definition">¶</a></dt>
<dd><p>Setter of mass data to be used for MDV comparison</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fragment</strong> (<em>str</em>) – name of target_fragment</p></li>
<li><p><strong>number</strong> (<em>int</em>) – [number] th isotopomer</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nothing.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mdv</span><span class="o">.</span><span class="n">set_mdv_for_comparison</span><span class="p">(</span><span class="n">fragment</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvData.set_mdvs_for_comparison">
<span class="sig-name descname"><span class="pre">set_mdvs_for_comparison</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold_ratio</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvData.set_mdvs_for_comparison" title="Permalink to this definition">¶</a></dt>
<dd><p>Setters of multiple data to be used for MDV comparison</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>threshold_ratios</strong> (<em>float</em>) – MDV data whose ratio (0.0-1.0) is above threshold_ratios are used for MDV comparison</p></li>
<li><p><strong>threshold_std</strong> (<em>float</em>) – MDV data whose std is below threshold_std are used for MDV comparison</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True/False</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>boolean</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mdv</span><span class="o">.</span><span class="n">set_mdvs_for_comparison</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvData.set_observed_fragments">
<span class="sig-name descname"><span class="pre">set_observed_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fragments</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvData.set_observed_fragments" title="Permalink to this definition">¶</a></dt>
<dd><p>Setter of observed fragment.</p>
<p>When new MdvData instance is generated ‘observed_fragment’ == ‘target_fragment’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fragments</strong> (<em>Array</em>) – List of fragment names calculated in calmdv fucntion</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nothing.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mdv</span><span class="o">.</span><span class="n">set_observed_fragments</span><span class="p">([</span><span class="s1">&#39;Phe_85&#39;</span><span class="p">,</span> <span class="s1">&#39;Ala_57&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvData.set_std">
<span class="sig-name descname"><span class="pre">set_std</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'absolute'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvData.set_std" title="Permalink to this definition">¶</a></dt>
<dd><p>Setter of standard deviation level</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<em>float</em>) – level of standard deviation.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – <p>Method to calculate stdev levels.</p>
<ul>
<li><p>’relative’: Levels are set by stdev = [value] * signal intensity.</p></li>
<li><p>’absolute’ (detault) : Levels are set by stdev = [value].</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nothing.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mdv</span><span class="o">.</span><span class="n">set_std</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;absolute&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvData.set_unused_mdv_for_comparison">
<span class="sig-name descname"><span class="pre">set_unused_mdv_for_comparison</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fragment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvData.set_unused_mdv_for_comparison" title="Permalink to this definition">¶</a></dt>
<dd><p>Setter of mass data to be ignored for MDV comparison</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fragment</strong> (<em>str</em>) – name of target_fragment</p></li>
<li><p><strong>number</strong> (<em>int</em>) – [number] th isotopomer</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nothing.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mdv</span><span class="o">.</span><span class="n">set_unused_mdv_for_comparison</span><span class="p">(</span><span class="n">fragment</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mfapy.mdv.MdvTimeCourseData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mfapy.mdv.</span></span><span class="sig-name descname"><span class="pre">MdvTimeCourseData</span></span><a class="headerlink" href="#mfapy.mdv.MdvTimeCourseData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvTimeCourseData.add_gaussian_noise">
<span class="sig-name descname"><span class="pre">add_gaussian_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stdev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'absolute'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'on'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvTimeCourseData.add_gaussian_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Addition of gausian noise to MDV data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stdev</strong> (<em>float</em>) – noise level (standard deviation of normal distribution)</p></li>
<li><p><strong>iteration</strong> (<em>int</em>) – number of sampleing (experimental)</p></li>
<li><p><strong>method</strong> (<em>str</em>) – <p>method to add gausian noise</p>
<ul>
<li><p>”relative”  intentsity = (randn() * stdev + 1) * original_intensity</p></li>
<li><p>”absolute” (default) intentsity = randn() * stdev) + original_intensity</p></li>
</ul>
</p></li>
<li><p><strong>normalize</strong> (<em>str</em>) – on (default)/off sum of ratio is set to 1.0</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True/False</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>boolean</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mdv</span><span class="o">.</span><span class="n">add_gaussian_noise</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvTimeCourseData.add_time_point">
<span class="sig-name descname"><span class="pre">add_time_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mdv_instance</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvTimeCourseData.add_time_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Addition of new time point</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<em>float</em>) – time point</p></li>
<li><p><strong>mdv_instance</strong> (<a class="reference internal" href="#mfapy.mdv.MdvData" title="mfapy.mdv.MdvData"><em>MdvData</em></a>) – MdvData instance</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>nothing</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mdv</span><span class="o">.</span><span class="n">add_time_point</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">mdv3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvTimeCourseData.generate_observed_mdv">
<span class="sig-name descname"><span class="pre">generate_observed_mdv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvTimeCourseData.generate_observed_mdv" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator of MDV related inforamtion in list format.</p>
<p>This function is onely used in model.set_experiment()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>required.</strong> (<em>Nor</em>) – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>id_array (array) Array of list of ids at each time point</p></li>
<li><p>ratio_array (array) Array of list of ratio data at each time point</p></li>
<li><p>std_array (array) Array of list of std data at each time point</p></li>
<li><p>use_array (array) Array of list of use data at each time point</p></li>
<li><p>observed_fragments (array) Array of list of observed fragments at each time point</p></li>
<li><p>data (array) Array of list of other information at each time point</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">id_array</span><span class="p">,</span> <span class="n">ratio_array</span><span class="p">,</span> <span class="n">std_array</span><span class="p">,</span> <span class="n">use_array</span><span class="p">,</span> <span class="n">observed_fragments</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mdv</span><span class="o">.</span><span class="n">generate_observed_mdv</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvTimeCourseData.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvTimeCourseData.get_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Getter of [number] th isotopomer in the MDV of [fragment] at [time].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<em>float</em>) – time point</p></li>
<li><p><strong>fragment</strong> (<em>str</em>) – name of target_fragment</p></li>
<li><p><strong>number</strong> (<em>int</em>) – [number] th isotopomer</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>ratio (float) Relative abundance of mass spectra data</p>
<p>std (float) Standard deviation of measured MDV data</p>
<p>use (str) Data to be used for MDV comparison. ‘use’ or ‘no’</p>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ratio</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">use</span> <span class="o">=</span> <span class="n">mdv</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s1">&#39;Leu85&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvTimeCourseData.get_number_of_measurement">
<span class="sig-name descname"><span class="pre">get_number_of_measurement</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvTimeCourseData.get_number_of_measurement" title="Permalink to this definition">¶</a></dt>
<dd><p>Getter of number of measurement of the MDV data set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>required.</strong> (<em>Nor</em>) – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of measurement</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">number_of_measurement</span> <span class="o">=</span> <span class="n">mdv</span><span class="o">.</span><span class="n">get_number_of_measurement</span><span class="p">()</span>
</pre></div>
</div>
<dl class="simple">
<dt>History</dt><dd><p>Revised at 27/5/2018</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvTimeCourseData.get_timecourse_data">
<span class="sig-name descname"><span class="pre">get_timecourse_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fragment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvTimeCourseData.get_timecourse_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Getter of time course MDV data</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tc</span> <span class="o">=</span> <span class="n">mdv</span><span class="o">.</span><span class="n">get_timecourse_data</span><span class="p">(</span><span class="s1">&#39;Leu85&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fragment</strong> (<em>name of target_fragment</em>) – </p></li>
<li><p><strong>number</strong> (<em>Number of isotope</em>) – </p></li>
<li><p><strong>Reterns</strong> – </p></li>
<li><p><strong>----------</strong> – </p></li>
<li><p><strong>tc</strong> (<em>Array of time course of Mass isotopomer</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvTimeCourseData.get_timepoints">
<span class="sig-name descname"><span class="pre">get_timepoints</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvTimeCourseData.get_timepoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Getter of Time points</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Reterns</strong> – </p></li>
<li><p><strong>----------</strong> – </p></li>
<li><p><strong>timepoints</strong> (<em>list of time points</em>) – </p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">timepoints</span> <span class="o">=</span> <span class="n">mdv</span><span class="o">.</span><span class="n">get_timepoints</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">timepoints</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">5</span><span class="p">,]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvTimeCourseData.has_data">
<span class="sig-name descname"><span class="pre">has_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvTimeCourseData.has_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Checker whether the MdvData instance has data of [number] th isotopomer in the MDV of [fragment] at [time].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<em>float</em>) – time point</p></li>
<li><p><strong>fragment</strong> (<em>str</em>) – name of target_fragment</p></li>
<li><p><strong>number</strong> (<em>int</em>) – [number] th isotopomer</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>TrueFalse</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Boolean</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">mdv</span><span class="o">.</span><span class="n">has_data</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Leu85&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="n">brabra</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvTimeCourseData.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'text'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvTimeCourseData.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to save MDV data in text/csv file</p>
<p>Files of each timepoint are generated with names filename+”timepoint”.txt</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – <p>filename of MDV data with the format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Name</span>    <span class="n">Spectrum</span>        <span class="n">Select</span>  <span class="n">MDV</span>     <span class="n">Std</span>
<span class="n">Ala57</span>   <span class="n">m0</span>      <span class="mi">1</span>       <span class="mf">0.566990778</span>     <span class="mf">0.000774686</span>
<span class="n">Ala57</span>   <span class="n">m1</span>      <span class="mi">1</span>       <span class="mf">0.148623963</span>     <span class="mf">0.000774686</span>
<span class="n">Ala57</span>   <span class="n">m2</span>      <span class="mi">1</span>       <span class="mf">0.039467636</span>     <span class="mf">0.000774686</span>
<span class="n">Ala57</span>   <span class="n">m3</span>      <span class="mi">1</span>       <span class="mf">0.244917622</span>     <span class="mf">0.000774686</span>
</pre></div>
</div>
</p></li>
<li><p><strong>format</strong> (<em>str</em>) – <p>file format:</p>
<ul>
<li><p>’csv’ : CSV.</p></li>
<li><p>’text’ (defalut) : tab-deliminated text.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True/False</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Boolean</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mdv</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;filename&#39;</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s2">&quot;csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvTimeCourseData.set_data">
<span class="sig-name descname"><span class="pre">set_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvTimeCourseData.set_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Setter of [number] th isotopomer in the MDV of [fragment] at [time].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<em>float</em>) – time point</p></li>
<li><p><strong>fragment</strong> (<em>str</em>) – name of target_fragment</p></li>
<li><p><strong>number</strong> (<em>int</em>) – [number] th isotopomer</p></li>
<li><p><strong>ratio</strong> (<em>float</em>) – Relative abundance of mass spectra data</p></li>
<li><p><strong>std</strong> (<em>float</em>) – Standard deviation of measured MDV data</p></li>
<li><p><strong>use</strong> (<em>str</em>) – Data to be used for MDV comparison. ‘use’ or ‘no’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>TrueFalse</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Boolean</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mdv</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Leu85&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.763</span><span class="p">,</span> <span class="mf">0.0054</span><span class="p">,</span> <span class="s1">&#39;use&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvTimeCourseData.set_mdvs_for_comparison">
<span class="sig-name descname"><span class="pre">set_mdvs_for_comparison</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold_ratio</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvTimeCourseData.set_mdvs_for_comparison" title="Permalink to this definition">¶</a></dt>
<dd><p>Setters of multiple data to be used for MDV comparison</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>threshold_ratios</strong> (<em>float</em>) – MDV data whose ratio (0.0-1.0) is above threshold_ratios are used for MDV comparison</p></li>
<li><p><strong>threshold_std</strong> (<em>float</em>) – MDV data whose std is below threshold_std are used for MDV comparison</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True/False</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>boolean</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mdv</span><span class="o">.</span><span class="n">set_mdvs_for_comparison</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvTimeCourseData.set_observed_fragments">
<span class="sig-name descname"><span class="pre">set_observed_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fragments</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvTimeCourseData.set_observed_fragments" title="Permalink to this definition">¶</a></dt>
<dd><p>Setter of observed fragment.</p>
<p>When new MdvData instance is generated ‘observed_fragment’ == ‘target_fragment’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fragments</strong> (<em>Array</em>) – List of fragment names calculated in calmdv fucntion</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nothing.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mdv</span><span class="o">.</span><span class="n">set_observed_fragments</span><span class="p">([</span><span class="s1">&#39;Phe_85&#39;</span><span class="p">,</span> <span class="s1">&#39;Ala_57&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.mdv.MdvTimeCourseData.set_std">
<span class="sig-name descname"><span class="pre">set_std</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'absolute'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.MdvTimeCourseData.set_std" title="Permalink to this definition">¶</a></dt>
<dd><p>Set standard deviation levels from mass sepctral intensity</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>method</strong> (<em>Method to calculate stdev levels:</em>) – ‘relative’ (detault): Levels are set by stdev = [value] * signal intensity
‘abusolute’: Levels are set by stdev = [value]</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mdv</span><span class="o">.</span><span class="n">set_std</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;absolute&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfapy.mdv.binomial">
<span class="sig-prename descclassname"><span class="pre">mfapy.mdv.</span></span><span class="sig-name descname"><span class="pre">binomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.binomial" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfapy.mdv.count_atom_number">
<span class="sig-prename descclassname"><span class="pre">mfapy.mdv.</span></span><span class="sig-name descname"><span class="pre">count_atom_number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">formula</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.count_atom_number" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfapy.mdv.transition_matrix">
<span class="sig-prename descclassname"><span class="pre">mfapy.mdv.</span></span><span class="sig-name descname"><span class="pre">transition_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">formula</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.mdv.transition_matrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-mfapy.metabolicmodel">
<span id="mfapy-metabolicmodel-module"></span><h2>mfapy.metabolicmodel module<a class="headerlink" href="#module-mfapy.metabolicmodel" title="Permalink to this heading">¶</a></h2>
<p>metabolicmodel.py:MetabolicModel class in mfapy</p>
<p>This is a core module of mfapy.</p>
<p>The module includes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MetabolicModel</span> <span class="k">class</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="id3">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Rewriting model construction part.</p></li>
<li><p>Check callbacklevel.</p></li>
</ul>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mfapy.metabolicmodel.</span></span><span class="sig-name descname"><span class="pre">MetabolicModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reactions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reversible</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metabolites</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_fragments</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class of MetabolicModel</p>
<p>An instances of this class has fuctions to analyze mass spectrometry based 13C MFA and INST MFA data.</p>
<p>An metabolicModel instance generates MDVData and CarbonSouece classes</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>instance of metabolic model</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>instance</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reactions</span><span class="p">,</span> <span class="n">reversible</span><span class="p">,</span> <span class="n">metabolites</span><span class="p">,</span> <span class="n">target_fragments</span> <span class="o">=</span> <span class="n">mfapy</span><span class="o">.</span><span class="n">mfapyio</span><span class="o">.</span><span class="n">load_metabolic_model</span><span class="p">(</span><span class="s2">&quot;example_1_toymodel_model.txt&quot;</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s2">&quot;text&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">mfapy</span><span class="o">.</span><span class="n">metabolicmodel</span><span class="o">.</span><span class="n">MetabolicModel</span><span class="p">(</span><span class="n">reactions</span><span class="p">,</span> <span class="n">reversible</span><span class="p">,</span> <span class="n">metabolites</span><span class="p">,</span> <span class="n">target_fragments</span><span class="p">)</span>
</pre></div>
</div>
<p>Attributes (incomplete):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">reactions</span> <span class="o">=</span> <span class="n">reactions</span>
<span class="bp">self</span><span class="o">.</span><span class="n">metabolites</span> <span class="o">=</span> <span class="n">metabolites</span>
<span class="bp">self</span><span class="o">.</span><span class="n">reversible</span> <span class="o">=</span> <span class="n">reversible</span>
<span class="bp">self</span><span class="o">.</span><span class="n">target_fragments</span> <span class="o">=</span> <span class="n">target_fragments</span>
<span class="bp">self</span><span class="o">.</span><span class="n">symmetry</span> <span class="o">=</span> <span class="p">{}</span>
<span class="bp">self</span><span class="o">.</span><span class="n">carbon_source</span> <span class="o">=</span> <span class="p">{}</span>
<span class="bp">self</span><span class="o">.</span><span class="n">experiments</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.add_perturbation">
<span class="sig-name descname"><span class="pre">add_perturbation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.add_perturbation" title="Permalink to this definition">¶</a></dt>
<dd><p>New state dict is generarate from a given state dict by an addition of small random perturbation to an independent flux</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>dict</em>) – Dictionary of metabolic state data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>check (boolean)</p></li>
<li><p>perturbed_state (dict)Dictionary of metabolic state data.</p></li>
<li><p>flux_vector (array) List of metabolic flux, metabolite concentration data.</p></li>
<li><p>reaction_name_list (array) List of ids</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">check</span><span class="p">,</span> <span class="n">perturbed_state</span><span class="p">,</span> <span class="n">flux_vector</span><span class="p">,</span> <span class="n">reaction_name_list</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">add_perturbation</span><span class="p">(</span><span class="n">state_dict</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>History</dt><dd><p>Newly created at 21/1/2021</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.calc_idv">
<span class="sig-name descname"><span class="pre">calc_idv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">carbon_sources</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.calc_idv" title="Permalink to this definition">¶</a></dt>
<dd><p>Calc IDV from given flux and carbon_sources.</p>
<p>Isotopomer distribution vector (IDV) was used to calc MDV at time = 0 in the INST mode.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">idv</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">calc_idv</span><span class="p">(</span><span class="n">flux</span><span class="p">,</span> <span class="n">carbon_sources</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flux</strong> (<em>dict</em>) – Dictionary of metabolic state inclucing metabolic flux and metabolite pool size levels.</p></li>
<li><p><strong>carbon_sources</strong> (<em>instance</em>) – Instance of carbon source object</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of idv</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>set_experiment()
generate_mdv()</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.calc_rss">
<span class="sig-name descname"><span class="pre">calc_rss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fluxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'flux'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.calc_rss" title="Permalink to this definition">¶</a></dt>
<dd><p>Getter to calc residual sum of square (RSS) level between estimated MDVs of ‘flux’ and measured MDVs in ‘experiment(s)’</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flux</strong> (<em>dict</em>) – Dictionary of metabolic flux distribution or independent flux vector</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – <ul>
<li><p>“independent”:Calculation of RSS from independent flux vector</p></li>
<li><p>”flux”:Calculation of RSS from state dictionary</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Residual sum of square (RSS)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rss</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">calc_rss</span><span class="p">(</span><span class="n">flux_opt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">rss</span>
<span class="go">7564.123</span>
</pre></div>
</div>
<dl class="simple">
<dt>History:</dt><dd><p>Call of calmdv funcion is removed.12/9/2014</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.check_independents">
<span class="sig-name descname"><span class="pre">check_independents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">independents</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.check_independents" title="Permalink to this definition">¶</a></dt>
<dd><p>Checker method to test whether a given vector of independent fluxes is able to produce feasible status (flux) vector within lower and upper boundaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>independents</strong> (<em>array</em>) – list of independent fluxes generated by self.get_independents</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>check (Boolean) True means that a given vector of independent fluxes is able to produce feasible status (flux) vector within lower and upper boundaries.</p></li>
<li><p>flux_vector (array) List of metabolic flux, metabolite concentration data.</p></li>
<li><p>reaction_name (array) List of ids</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">check</span><span class="p">,</span> <span class="n">flux_vector</span><span class="p">,</span> <span class="n">reaction_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_independents</span><span class="p">(</span><span class="n">independents</span><span class="p">)</span>
</pre></div>
</div>
<p>History:</p>
<blockquote>
<div><p>Newly created at 21/1/2021</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.clear_experiment">
<span class="sig-name descname"><span class="pre">clear_experiment</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.clear_experiment" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear all ‘experiment set(s)’ in the metabolic model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>required</strong> (<em>Not</em>) – </p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">clear_experiment</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>model.set_experiment()</p>
</div>
<dl class="simple">
<dt>History:</dt><dd><p>Newly developed at 4/9/2014</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.fitting_flux">
<span class="sig-name descname"><span class="pre">fitting_flux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SLSQP'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'result'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.fitting_flux" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for fitting a metabolic model to multiple experiments</p>
<p>Used parameters in self.configuration().</p>
<blockquote>
<div><ul class="simple">
<li><p>‘iteration_max’: Maximal number of interation in the optimizers. Example: model.set_configuration(iteration_max = 1000)</p></li>
<li><p>‘number_of_repeat’: Number of repeated execution by ‘deep’ functions. Example: model.set_configuration(number_of_repeat = 2)</p></li>
<li><p>‘ncpus’: Number of CPUs used in parallel processing. Example: model.set_configuration(ncpus = 16)</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em>) – <p>Algorism used for optimization.</p>
<ul>
<li><p>’deep’: Repeated execution of SLSQP &amp; LN_PRAXIS</p></li>
<li><p>’SLSQP’: Sequential Least SQuares Programming algorithm implemented in scipy</p></li>
<li><p>’COBYLA’: Constrained Optimization By Linear Approximation implemented by scipy</p></li>
<li><p>”LN_BOBYQA”:The BOBYQA algorithm for bound constrained optimization without derivatives by nlopt</p></li>
<li><p>”LN_SBPLX”: Sbplx (based on Subplex, (a variant of Nelder-Mead that uses Nelder-Mead on a sequence of subspaces) by nlopt</p></li>
<li><p>”LN_NEWUOA”: The NEWUOA software for unconstrained optimization without derivatives by nlopt</p></li>
<li><p>”LN_COBYLA”: Constrained Optimization By Linear Approximation implemented by nlopt</p></li>
<li><p>”LN_PRAXIS”: Gradient-free local optimization via the “principal-axis method” implemented by nlopt</p></li>
<li><p>”LN_NELDERMEAD”: the original Nelder-Mead simplex algorithm by nlopt</p></li>
<li><p>”GN_ESCH”: Evolutionary Algorithm for global optimization by nlopt</p></li>
<li><p>”GN_CRS2_LM”: Controlled random searchimplemented for global optimizatoin by nlopt</p></li>
<li><p>”GN_DIRECT_L”:  DIviding RECTangles algorithm for global optimization by nlopt</p></li>
<li><p>”GN_IRES”: Improved Stochastic Ranking Evolution Strategy by nlopt</p></li>
<li><p>”GN_AGS”: AGS NLP solver by nlopt</p></li>
</ul>
</p></li>
<li><p><strong>flux</strong> (<em>dict</em>) – <p>Initial flux distribution generated by self.generate_initial_states():</p>
<ul>
<li><p>When flux is a dict of one state, single fitting trial is executed.</p></li>
<li><p>When flux is a array of multiple dists of states, muptiple fitting trial is exected by using the parallel processing.</p></li>
</ul>
</p></li>
<li><p><strong>output</strong> (<em>str</em>) – <p>Output method.</p>
<ul>
<li><p>’result’ (default): Fitting problem is solved inside of the function.</p></li>
<li><p>’for_parallel’: Fitting problems is NOT solved inside of the function. In this mode, a tupple of parameters for fit_r_mdv_pyopt() functions are generated for parallel processinng.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>stop condition</p>
<blockquote>
<div><ul class="simple">
<li><p>[number_of_initial_states == 1 ] Str of stop condition.</p></li>
<li><p>[number_of_initial_states &gt; 1 ] Array of str of stop condition.</p></li>
</ul>
</div></blockquote>
<ul>
<li><p>flux_opt (array or dict): Initial flux distribution generated by self.generate_initial_states()</p>
<blockquote>
<div><ul class="simple">
<li><p>[number_of_initial_states == 1 ] dict of optimzed metabolic state.</p></li>
<li><p>[number_of_initial_states &gt; 1 ] Array of dict of optimzed metabolic state. Sorted by ascending order of their RSS levels</p></li>
</ul>
</div></blockquote>
</li>
<li><p>RSS_bestfit (array or float) : Dictionary of metabolic state inclucing metabolic flux and metabolite pool size levels.</p>
<blockquote>
<div><ul class="simple">
<li><p>[number_of_initial_states == 1 ] Dictionary of metabolic state inclucing metabolic flux and metabolite pool size levels.</p></li>
<li><p>[number_of_initial_states &gt; 1 ] Array of dictionary of metabolic state inclucing metabolic flux and metabolite pool size levels.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>state  (str or array)</p></li>
</ul>
</p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Single fitting trial</span>
<span class="c1">#</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">state</span><span class="p">,</span> <span class="n">flux_initial</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate_initial_states</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">state</span><span class="p">,</span> <span class="n">RSS_bestfit</span><span class="p">,</span> <span class="n">flux_opt</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fitting_flux</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;deep&#39;</span><span class="p">,</span> <span class="n">flux</span> <span class="o">=</span> <span class="n">flux_initial</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">results</span><span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;deep&quot;</span><span class="p">,</span> <span class="n">flux_opt</span><span class="p">)]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">pool_size</span> <span class="o">=</span> <span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># Multipe fitting trials by using parallel python</span>
<span class="c1">#</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">state</span><span class="p">,</span> <span class="n">flux_initial</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate_initial_states</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">state</span><span class="p">,</span> <span class="n">RSS_bestfit</span><span class="p">,</span> <span class="n">flux_opt_slsqp</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fitting_flux</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;SLSQP&quot;</span><span class="p">,</span> <span class="n">flux</span> <span class="o">=</span> <span class="n">flux_initial</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">results</span><span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;deep&quot;</span><span class="p">,</span> <span class="n">flux_opt</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">pool_size</span> <span class="o">=</span> <span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># Generating parameters for parallel processing</span>
<span class="c1">#</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">parameters</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fitting_flux</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;SLSQP&quot;</span><span class="p">,</span> <span class="n">flux</span> <span class="o">=</span> <span class="n">flux_initial</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;for_parallel&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>generate_initial_states()</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.generate_calmdv">
<span class="sig-name descname"><span class="pre">generate_calmdv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.generate_calmdv" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructer of the python function to calculate MDV of target fragments from a metabolic flux distribution.</p>
<p>This function is performed in reconstruct()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mode</strong> (<em>str</em>) – optimize EMU network reduction (experimental)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>string, cython_string (str) Texts of python code describing calmdv and diffmdv functions for python 3 and Cython (Experimental)</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calmdv_text</span><span class="p">,</span> <span class="n">ccalmdv_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_calmdv</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.generate_carbon_source_template">
<span class="sig-name descname"><span class="pre">generate_carbon_source_template</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.generate_carbon_source_template" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator of a templete of CarbonSourse instance. Labeling information of carbon sources will be added to the instance.</p>
<p>Carbon source compounds are derived from the metabolic model (//Metabolites)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>required.</strong> (<em>Not</em>) – </p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">carbon_source_idv</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate_carbon_source_templete</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>CarbonSource.py</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.generate_carbon_source_templete">
<span class="sig-name descname"><span class="pre">generate_carbon_source_templete</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.generate_carbon_source_templete" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.generate_ci_template">
<span class="sig-name descname"><span class="pre">generate_ci_template</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">targets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.generate_ci_template" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator of a template dictionary to keep confidence interval search results.</p>
<dl class="simple">
<dt>The templatedisctionary generated by this method is used for:</dt><dd><ul class="simple">
<li><p>Setting reactions, metabolites, and reversible reactions for CI searching in self.search_ci method.</p></li>
<li><p>Store all record of CI searching by self.search_ci method.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>targets</strong> (<em>str</em>) – <ul class="simple">
<li><p>‘normal’ Free reversible and inreversible reactions</p></li>
<li><p>’independent’ Independent reactions</p></li>
<li><p>’all’ all reactions</p></li>
<li><p>’without_reversible_reactions’ inreversible reactions</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>template dictionary</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ci</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate_ci_templete</span><span class="p">(</span><span class="n">targets</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;reaction&quot;</span><span class="p">,</span><span class="s2">&quot;r29_g6pdh&quot;</span><span class="p">),(</span><span class="s2">&quot;reaction&quot;</span><span class="p">,</span><span class="s2">&quot;r27_pc&quot;</span><span class="p">),(</span><span class="s2">&quot;reaction&quot;</span><span class="p">,</span><span class="s2">&quot;r28_mae&quot;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ci</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate_ci_templete</span><span class="p">(</span><span class="n">targets</span> <span class="o">=</span> <span class="s1">&#39;normal&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>search_ci.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.generate_ci_templete">
<span class="sig-name descname"><span class="pre">generate_ci_templete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">targets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.generate_ci_templete" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.generate_initial_states">
<span class="sig-name descname"><span class="pre">generate_initial_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_states</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.generate_initial_states" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator of random initial metabolic states for model fitting</p>
<p>Initial metabolic states are randomly generated for “iterations” times from which better states with lower RSS (number_of_initial_states) were selected.</p>
<p>Used parameters in self.configuration().</p>
<blockquote>
<div><ul class="simple">
<li><p>‘initial_search_iteration_max’: Maximal number of interation in the optimizers. Example: model.set_configuration(initial_search_iteration_max = 1000)</p></li>
<li><p>‘ncpus’: Number of CPUs used in parallel processing. Example: model.set_configuration(ncpus = 16)</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em>) – computational method
* ‘normal’ :  Generation of flux distributions by single thread.
* ‘parallel’ : Parallel generation of flux distributions using parallel processing.</p></li>
<li><p><strong>iterations</strong> (<em>int</em>) – Number of trials to generate initial metabolic state. A trial sometimes failed due to a bad optimization state.</p></li>
<li><p><strong>initial_states</strong> (<em>int</em>) – Number of initial metabolic state(s) with lower RSS to be generated.</p></li>
<li><p><strong>template</strong> (<em>array</em>) – Array of templete metabolic state(s) dictionaries. When template is available, initial metabolic state(s) similiar to the templete metabolic state are generated. This function is used in the grid search fucntion.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Dictionary of metabolic state inclucing metabolic flux and metabolite pool size levels.</p>
<blockquote>
<div><ul class="simple">
<li><p>[number_of_initial_states &gt; 1 ] Array of dictionary of metabolic state inclucing metabolic flux and metabolite pool size levels.</p></li>
<li><p>[number_of_initial_states == 1 ] Dictionary of metabolic state inclucing metabolic flux and metabolite pool size levels.</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><dl class="simple">
<dt>state  (str or array)<span class="classifier">stop condition</span></dt><dd><ul>
<li><p>[number_of_initial_states &gt; 1 ] Str of stop condition.</p></li>
<li><p>[number_of_initial_states == 1 ] Array of Str of stop condition.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>flux (array or dict)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">state</span><span class="p">,</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate_initial_states</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state</span><span class="p">,</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate_initial_states</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">template</span> <span class="o">=</span> <span class="n">flux</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">Fitting</span></code></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.generate_mdv">
<span class="sig-name descname"><span class="pre">generate_mdv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">carbon_sources</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timepoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">startidv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.generate_mdv" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator of a MdvData instance including MDV data generated from given flux and carbon sources.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flux</strong> (<em>dict</em>) – Dictionary of metabolic state inclucing metabolic flux and metabolite pool size levels.</p></li>
<li><p><strong>carbon_sources</strong> (<em>instance</em>) – Instance of CarbonSource</p></li>
<li><p><strong>timepoint</strong> (<em>array</em>) – For INST-13C MFA. An array of time points of measurement in MDV</p></li>
<li><p><strong>startidv</strong> (<em>array</em>) – array of idv as starting isotope distribution for INST</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>instance* MdvData instance</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mdv</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate_mdv</span><span class="p">(</span><span class="n">flux</span><span class="p">,</span> <span class="n">mdv_carbon_sources</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>generate_carbonsource_MDV</p>
</div>
<dl class="simple">
<dt>History:</dt><dd><p>140912 calc_MDV_from_flux instead of calmdv is used.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.generate_state">
<span class="sig-name descname"><span class="pre">generate_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">template</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.generate_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator of a random metabolic flux distribution.</p>
<p>Used parameters in self.configuration().</p>
<blockquote>
<div><ul class="simple">
<li><p>‘initial_search_iteration_max’: Maximal number of interation in the optimizers. Example: model.set_configuration(initial_search_iteration_max = 1000)</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>template</strong> (<em>dict</em>) – Dictionary of metabolic state inclucing metabolic flux and metabolite pool size levels. When template is available, metabolic state most similar to the template is generated. The function is used in the grid search.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>flux (dict) Dictionary of metabolic state inclucing metabolic flux and metabolite pool size levels.</p></li>
<li><p>independent_flux (array) List of independent flux</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">flux</span><span class="p">,</span> <span class="n">independent_flux</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate_intial_flux_distribution</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.generate_state_dict">
<span class="sig-name descname"><span class="pre">generate_state_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tmp_r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.generate_state_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator of a state dict from a given vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tmp_r</strong> (<em>array</em>) – tmp_r = numpy.dot(matrixinv, Rm_intial)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of metabolic state inclucing metabolic flux and metabolite pool size levels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">state_dict</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate_state_dict</span><span class="p">(</span><span class="n">tmp_r</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.get_constrain">
<span class="sig-name descname"><span class="pre">get_constrain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.get_constrain" title="Permalink to this definition">¶</a></dt>
<dd><p>Getter of constrains of metabolic reaction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>group</strong> (<em>str</em>) – group of parameters (“reaction”, “reversible”, “metabolite”)</p></li>
<li><p><strong>id</strong> (<em>str</em>) – id in model definition</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>type (str) type of constrain “fitting”, “fixed”, “free”, “pseudo”</p></li>
<li><p>value (float) Level of metabolic flux</p></li>
<li><p>stdev (float) Standard deviation of metabolic flux level used for ‘fitting’ type reactions.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">stdev</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_constrain</span><span class="p">(</span><span class="s2">&quot;reaction&quot;</span><span class="p">,</span><span class="s2">&quot;pgi&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>set_constrain</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.get_degree_of_freedom">
<span class="sig-name descname"><span class="pre">get_degree_of_freedom</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.get_degree_of_freedom" title="Permalink to this definition">¶</a></dt>
<dd><p>Getter of degree of freedom of the model</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">degree_of_freedom</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_degree_of_freedom</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>degree of freedom.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.get_independents">
<span class="sig-name descname"><span class="pre">get_independents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.get_independents" title="Permalink to this definition">¶</a></dt>
<dd><p>Getter of independent status (flux) vector, its lower and upper boundaries and a list of independent flux ids of given state (flux) dict.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">independent_vector</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">independent_list</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_independents</span><span class="p">(</span><span class="n">state_dict</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>flux</strong> (<em>dict</em>) – Dictionary of metabolic state data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>independent_vector (array) list of independent flux values</p></li>
<li><p>lb (array) list of independent flux values</p></li>
<li><p>ub (array) list of independent flux values</p></li>
<li><p>independent_list (array) list of independent fluxes, metabolites, and reversible reactions.</p></li>
</ul>
</p>
</dd>
</dl>
<dl class="simple">
<dt>History:</dt><dd><p>Newly created at 21/1/2021</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.get_number_of_independent_measurements">
<span class="sig-name descname"><span class="pre">get_number_of_independent_measurements</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.get_number_of_independent_measurements" title="Permalink to this definition">¶</a></dt>
<dd><p>Getter of number of independent measurements of the model</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>number of independent measurements.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
<dl class="simple">
<dt>History:</dt><dd><p>29/9/2014 Modified to consider “fitting” flux information.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">number_of_independent_measurements</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_number_of_independent_measurements</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.get_thres_confidence_interval">
<span class="sig-name descname"><span class="pre">get_thres_confidence_interval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'F_dist'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.get_thres_confidence_interval" title="Permalink to this definition">¶</a></dt>
<dd><p>Getter to obtain a threshold level of RSS for searching confidence interval</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flux</strong> (<em>dict</em>) – Dictionary of best fitted flux distribution.</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – confidence level. For 95% confience interval, please set alpha = 0.05</p></li>
<li><p><strong>dist</strong> (<em>str</em>) – Probability distribution for test
* ‘F-dist’ (default): Using F-distribution
* ‘chai-dist’:Using Chai-square distribution</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>thres (float) a threshold level of RSS for searching confidence interval</p></li>
<li><p>number_of_measurements (int) number of measurements</p></li>
<li><p>degree_of_freedom (int) degree of freedom</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">thres</span><span class="p">,</span> <span class="n">number_of_reactions</span><span class="p">,</span> <span class="n">degree_of_freedom</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_thres_confidence_interval</span><span class="p">(</span><span class="n">RSS</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">dist</span> <span class="o">=</span> <span class="s1">&#39;F_dist&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.goodness_of_fit">
<span class="sig-name descname"><span class="pre">goodness_of_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.goodness_of_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Getter to calculate goodness-of-fit of a given flux distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flux</strong> (<em>dict</em>) – Dictionary of metabolic flux distribution</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – Confidence level. Default is 0.05.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>pvalue (float) p-value determined by chi-squere test.</p></li>
<li><p>rss_thres (float) Threshold RSS at the alpha levels.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pvalue</span><span class="p">,</span> <span class="n">rss_thres</span><span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">goodness_of_fit</span><span class="p">(</span><span class="n">flux_opt_fitted</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.load_mdv_data">
<span class="sig-name descname"><span class="pre">load_mdv_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'text'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.load_mdv_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Load MDV data from the text file. This function generate new instance of mfapy.mdv class from a instance of mfapy.model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – <p>filename of MDV data with following format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Name</span>    <span class="n">Spectrum</span>        <span class="n">Select</span>  <span class="n">MDV</span>     <span class="n">Std</span>
<span class="n">Ala57</span>   <span class="n">m0</span>      <span class="mi">1</span>       <span class="mf">0.566990778</span>     <span class="mf">0.000774686</span>
<span class="n">Ala57</span>   <span class="n">m1</span>      <span class="mi">1</span>       <span class="mf">0.148623963</span>     <span class="mf">0.000774686</span>
<span class="n">Ala57</span>   <span class="n">m2</span>      <span class="mi">1</span>       <span class="mf">0.039467636</span>     <span class="mf">0.000774686</span>
<span class="n">Ala57</span>   <span class="n">m3</span>      <span class="mi">1</span>       <span class="mf">0.244917622</span>     <span class="mf">0.000774686</span>
</pre></div>
</div>
</p></li>
<li><p><strong>format</strong> (<em>str</em>) – “text” (defalut) or “csv”</p></li>
<li><p><strong>output</strong> (<em>str</em>) – “normal” (defalut) or “debug”</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True/False</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Boolean</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mdv</span> <span class="o">=</span> <span class="n">load_mdv_data</span><span class="p">(</span><span class="s1">&#39;filename&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.load_states">
<span class="sig-name descname"><span class="pre">load_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'text'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.load_states" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a text/csv file with ‘reacton type’ information to generate new states dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – <p>filename of flux data with following format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span>    <span class="n">Id</span>      <span class="nb">type</span>    <span class="n">flux_calue</span>      <span class="n">flux_std</span>        <span class="n">lb</span>      <span class="n">ub</span>
<span class="n">reaction</span>        <span class="n">v1</span>      <span class="n">fixed</span>   <span class="mi">100</span>     <span class="mi">1</span>       <span class="mf">0.001</span>   <span class="mi">100</span>
<span class="n">reaction</span>        <span class="n">v2</span>      <span class="n">free</span>    <span class="mi">100</span>     <span class="mi">1</span>       <span class="mf">0.001</span>   <span class="mi">100</span>
<span class="n">reaction</span>        <span class="n">v3</span>      <span class="n">free</span>    <span class="mi">50</span>      <span class="mi">1</span>       <span class="mf">0.001</span>   <span class="mi">100</span>
<span class="n">metabolites</span>     <span class="n">AcCoA</span>   <span class="n">fixed</span>   <span class="mi">1</span>       <span class="mi">1</span>       <span class="mf">0.001</span>   <span class="mi">100</span>
<span class="n">metabolites</span>     <span class="n">OAC</span>     <span class="n">fixed</span>   <span class="mi">1</span>       <span class="mi">1</span>       <span class="mf">0.001</span>   <span class="mi">100</span>
<span class="n">metabolites</span>     <span class="n">OACs</span>    <span class="n">fixed</span>   <span class="mi">1</span>       <span class="mi">1</span>       <span class="mf">0.001</span>   <span class="mi">100</span>
<span class="n">metabolites</span>     <span class="n">OACx</span>    <span class="n">fixed</span>   <span class="mi">1</span>       <span class="mi">1</span>       <span class="mf">0.001</span>   <span class="mi">100</span>
<span class="n">reversible</span>      <span class="n">FUM</span>     <span class="n">free</span>    <span class="mi">1</span>       <span class="mi">1</span>       <span class="mf">0.001</span>   <span class="mi">100</span>
</pre></div>
</div>
</p></li>
<li><p><strong>format</strong> – ‘csv’ CSV or ‘text’tab-deliminated text.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of states dict.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">states</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">load_states</span><span class="p">(</span><span class="s2">&quot;test.csv&quot;</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.modelcheck">
<span class="sig-name descname"><span class="pre">modelcheck</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.modelcheck" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to check medel definition data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nothing</strong> – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nothing.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">datacheck</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>reconstruct</p>
</div>
<dl class="simple">
<dt>History:</dt><dd><p>Newly developed for version 059</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.posterior_distribution">
<span class="sig-name descname"><span class="pre">posterior_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.posterior_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator of posterior distribution by the Metropolis-Hastings algorism</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_dict</strong> (<em>dist</em>) – Dictionary of initial metabolic state</p></li>
<li><p><strong>number_of_steps</strong> (<em>int</em>) – Length of Markov-chain</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Returns</dt><dd><p>array: 2d array. Markov-chain of metabolic state vector</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">record</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">posterior_distribution</span><span class="p">(</span><span class="n">perturbed_state</span><span class="p">,</span> <span class="n">number_of_steps</span> <span class="o">=</span> <span class="n">numberofsteps</span><span class="p">)</span>
</pre></div>
</div>
<p>History:</p>
<blockquote>
<div><p>Newly created at 21/1/2021</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.reconstruct">
<span class="sig-name descname"><span class="pre">reconstruct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'no'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.reconstruct" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to reconstruct the metabolic model to generate new stoichiometry matrix and a function to
calculate MDV data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mode</strong> (<em>str</em>) – experimental</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>calmdv_text (dict) The dictionary has two keys. “calmdv” and “diffmdv” are instance of functions for 13C-MFA and INST-13C-MFA to generate MDV from a given metabolic flux, respectively.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>update()</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.save_states">
<span class="sig-name descname"><span class="pre">save_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'text'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.save_states" title="Permalink to this definition">¶</a></dt>
<dd><p>Save state dict to a text/csv file with ‘type’ information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – filename of MDV data with the format.</p></li>
<li><p><strong>dict</strong> (<em>dict</em>) – dictinary of metabolic state (flux)</p></li>
<li><p><strong>format</strong> – ‘csv’ CSV or ‘text’tab-deliminated text.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True/False</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Boolean</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">save_states</span><span class="p">(</span><span class="n">flux_dict</span><span class="p">,</span> <span class="s2">&quot;test.csv&quot;</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.search_ci">
<span class="sig-name descname"><span class="pre">search_ci</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'grid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'F_dist'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputthres</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.search_ci" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to estimate confidence intervals using information in a ‘ci’ dictionary.</p>
<p>Used parameters in self.configuration().</p>
<blockquote>
<div><ul class="simple">
<li><p>‘grid_search_iterations’ (default = 1): MNumber of trials for model fitting at each point in grid search. Example: model.set_configuration(grid_search_iterations = 1)</p></li>
<li><p>‘number_of_repeat’(default = 50): Number of initial metabolic flux disributions generated for each trial in grid search.Best initial metabolic flux disribution with smallest RSS is employed.</p></li>
<li><p>‘number_of_repeat’: Number of repeated execution by ‘deep’ functions. Example: model.set_configuration(number_of_repeat = 2)</p></li>
<li><p>‘ncpus’: Number of CPUs used in parallel processing. Example: model.set_configuration(ncpus = 16)</p></li>
</ul>
</div></blockquote>
<dl>
<dt>Argss:</dt><dd><p>ci (dict): dictionary for storeing confidence interval results. ci is generated by self.generate_ci_templete()</p>
<p>flux (dict): dict of metabolic state (best fitted)</p>
<p>method (str): ‘grid’ (Grid search method) is available</p>
<p>alpha (float): (default 0.05) Confidence interval level. 0.05 means a 95% confidence interval level</p>
<dl class="simple">
<dt>dist (str):</dt><dd><ul class="simple">
<li><p>‘F-dist’ (default): Using F-distribution</p></li>
<li><p>‘chai-dist’:Using Chai-square distribution</p></li>
</ul>
</dd>
</dl>
<p>outputthres (float): The grid search results larger than outputthres * threshold rss were removed from output</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary of confidence interval results.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ci</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate_ci_templete</span><span class="p">(</span><span class="n">targets</span> <span class="o">=</span> <span class="s1">&#39;independent&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ci</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">search_confidence_interval_parallel</span><span class="p">(</span><span class="n">ci</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;grid&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.set_boundary">
<span class="sig-name descname"><span class="pre">set_boundary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ub</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.set_boundary" title="Permalink to this definition">¶</a></dt>
<dd><p>Setter of a lower and upper boundaries of metablic states</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>group</strong> (<em>str</em>) – metabolite, reaction, reversible</p></li>
<li><p><strong>id</strong> (<em>str</em>) – id of state parameter</p></li>
<li><p><strong>lb</strong> (<em>float</em>) – lower boundary</p></li>
<li><p><strong>ub</strong> (<em>float</em>) – upper boundary</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True/False.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Booleans</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">set_boundary</span><span class="p">(</span><span class="s2">&quot;reaction&quot;</span><span class="p">,</span> <span class="s1">&#39;HEX1&#39;</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>set_constrain</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.set_configuration">
<span class="sig-name descname"><span class="pre">set_configuration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.set_configuration" title="Permalink to this definition">¶</a></dt>
<dd><p>Setter of a configuration of model parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*args</strong> (<em>list</em>) – “parameter_name = number”</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nothing.</p>
</dd>
</dl>
<p>Parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;callbacklevel&#39;</span><span class="p">:</span> <span class="n">default</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;callbacklevel&#39;</span> <span class="n">determines</span> <span class="n">a</span> <span class="n">frequency</span> <span class="n">level</span> <span class="n">of</span> <span class="n">callbacks</span> <span class="kn">from</span> <span class="nn">metabolic</span> <span class="n">model</span><span class="o">.</span>
    <span class="c1"># 0: No call back</span>
    <span class="c1"># 1: Error report</span>
    <span class="c1"># 2: Simple pregress report for grid search</span>
    <span class="c1"># 3: Detailed pregress report for grid search</span>
    <span class="c1"># 4: Simple pregress report for flux fitting</span>
    <span class="c1"># 5: Detailed pregress report for flux fitting</span>
    <span class="c1"># 7: Detailed report for model constrution</span>
    <span class="c1"># 8: Debug</span>
<span class="s1">&#39;iteration_max&#39;</span><span class="p">:</span> <span class="n">default</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">Maximal</span> <span class="n">number</span> <span class="n">of</span> <span class="n">interations</span> <span class="p">(</span><span class="n">steps</span><span class="p">)</span> <span class="ow">in</span> <span class="n">each</span> <span class="n">fitting</span> <span class="n">task</span><span class="o">.</span>
<span class="s1">&#39;default_reaction_lb&#39;</span><span class="p">:</span> <span class="n">default</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span>
<span class="s1">&#39;default_reaction_ub&#39;</span><span class="p">:</span> <span class="n">default</span> <span class="o">=</span> <span class="mf">5000.0</span><span class="p">,</span>
<span class="s1">&#39;default_metabolite_lb&#39;</span><span class="p">:</span> <span class="n">default</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span>
<span class="s1">&#39;default_metabolite_ub&#39;</span><span class="p">:</span> <span class="n">default</span> <span class="o">=</span> <span class="mf">500.0</span><span class="p">,</span>
<span class="s1">&#39;default_reversible_lb&#39;</span><span class="p">:</span> <span class="n">default</span> <span class="o">=</span> <span class="o">-</span><span class="mi">300</span><span class="p">,</span>
<span class="s1">&#39;default_reversible_ub&#39;</span><span class="p">:</span> <span class="n">default</span> <span class="o">=</span> <span class="mf">300.0</span><span class="p">,</span>
    <span class="n">Default</span> <span class="n">lower</span> <span class="ow">and</span> <span class="n">upper</span> <span class="n">boundaries</span> <span class="n">used</span> <span class="n">only</span> <span class="n">when</span> <span class="n">there</span> <span class="ow">is</span> <span class="n">no</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">model</span> <span class="n">definition</span> <span class="n">file</span><span class="o">.</span>
<span class="s1">&#39;grid_search_iterations&#39;</span><span class="p">:</span> <span class="n">default</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">Number</span> <span class="n">of</span> <span class="n">trials</span> <span class="k">for</span> <span class="n">model</span> <span class="n">fitting</span> <span class="n">at</span> <span class="n">each</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">grid</span> <span class="n">search</span><span class="o">.</span>
<span class="s1">&#39;initial_search_repeats_in_grid_search&#39;</span><span class="p">:</span> <span class="n">default</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
    <span class="n">Number</span> <span class="n">of</span> <span class="n">initial</span> <span class="n">metabolic</span> <span class="n">flux</span> <span class="n">disributions</span> <span class="n">generated</span> <span class="k">for</span> <span class="n">each</span> <span class="n">trial</span> <span class="ow">in</span> <span class="n">grid</span> <span class="n">search</span><span class="o">.</span>
    <span class="n">Best</span> <span class="n">initial</span> <span class="n">metabolic</span> <span class="n">flux</span> <span class="n">disribution</span> <span class="k">with</span> <span class="n">smallest</span> <span class="n">RSS</span> <span class="ow">is</span> <span class="n">employed</span><span class="o">.</span>
<span class="s1">&#39;initial_search_iteration_max&#39;</span><span class="p">:</span> <span class="n">default</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">Maximal</span> <span class="n">number</span> <span class="n">of</span> <span class="n">interations</span> <span class="p">(</span><span class="n">steps</span><span class="p">)</span> <span class="n">allowed</span> <span class="ow">in</span> <span class="n">each</span> <span class="n">task</span> <span class="n">to</span> <span class="n">find</span> <span class="n">feasible</span> <span class="n">initial</span> <span class="n">metabolic</span> <span class="n">flux</span> <span class="n">distribution</span><span class="o">.</span>
<span class="s1">&#39;add_naturalisotope_in_calmdv&#39;</span><span class="p">:</span><span class="n">default</span> <span class="o">=</span> <span class="s2">&quot;no&quot;</span>
    <span class="n">For</span> <span class="n">INST</span><span class="o">-</span><span class="mi">13</span><span class="n">C</span> <span class="n">MFA</span><span class="o">.</span> <span class="n">Natural</span> <span class="n">isotope</span> <span class="ow">is</span> <span class="n">added</span> <span class="n">to</span> <span class="n">MDVs</span> <span class="n">of</span> <span class="nb">all</span> <span class="n">intermediate</span> <span class="n">at</span> <span class="n">time</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="s1">&#39;number_of_repeat&#39;</span><span class="p">:</span><span class="n">default</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">For</span> <span class="s2">&quot;deep&quot;</span> <span class="n">function</span> <span class="n">of</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitting</span> <span class="n">flux</span><span class="o">.</span> <span class="s2">&quot;Global&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;Local&quot;</span> <span class="n">optimization</span> <span class="n">methods</span> <span class="n">are</span> <span class="n">repeated</span> <span class="k">for</span> <span class="n">n</span> <span class="n">times</span><span class="o">.</span>
<span class="s1">&#39;ncpus&#39;</span><span class="p">:</span><span class="n">default</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">Number</span> <span class="n">of</span> <span class="n">CPUs</span> <span class="n">used</span> <span class="ow">in</span> <span class="n">parallel</span> <span class="n">processing</span>
<span class="s1">&#39;odesolver&#39;</span><span class="p">:</span> <span class="n">default</span> <span class="o">=</span> <span class="s2">&quot;scipy&quot;</span> <span class="c1"># or &quot;sundials&quot;</span>
    <span class="n">Only</span> <span class="s2">&quot;scipy&quot;</span> <span class="ow">is</span> <span class="n">avaliable</span> <span class="n">due</span> <span class="n">to</span> <span class="n">memory</span> <span class="n">leak</span> <span class="n">problem</span> <span class="n">of</span> <span class="n">sundials</span>
</pre></div>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">set_configuration</span><span class="p">(</span><span class="n">callbacklevel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">set_configuration</span><span class="p">(</span><span class="n">iteration_max</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.set_constrain">
<span class="sig-name descname"><span class="pre">set_constrain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stdev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.set_constrain" title="Permalink to this definition">¶</a></dt>
<dd><p>Setter of a metabolic constrains.</p>
<p>Please perform update() after model modification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>group</strong> (<em>str</em>) – group of parameters (“reaction”, “reversible”, “metabolite”)</p></li>
<li><p><strong>id</strong> (<em>str</em>) – id in model definition</p></li>
<li><p><strong>type</strong> (<em>str</em>) – type of constrain “fitting”, “fixed”, “free”, “pseudo”:
* “fitting” : For the calclation of RSS by using “value” and stdev
* “fixed”   : Fixed to “value”. Not used for the calculation of RSS.
* “free”    : Free between lower and upper boundary. Not used for the calculation of RSS.
* “pseudo”  : Pseudo reaction is a special “free” reaction to consider G-index. The reaction is ignored in a stoichiometry matrix. However, the reaction is considered in the MDV calculation.</p></li>
<li><p><strong>value</strong> (<em>float</em>) – Level of metabolic flux</p></li>
<li><p><strong>stdev</strong> (<em>float</em>) – Standard deviation of metabolic flux level used for ‘fitting’ type reactions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True/False.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Booleans</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">set_fixed_reaction</span><span class="p">(</span><span class="s2">&quot;reaction&quot;</span><span class="p">,</span> <span class="s1">&#39;pgi&#39;</span><span class="p">,</span> <span class="s2">&quot;fixed&quot;</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>get_constrain</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.set_constraints_from_state_dict">
<span class="sig-name descname"><span class="pre">set_constraints_from_state_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.set_constraints_from_state_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Reaction types, value, stdev, lb, and ub are set from the state dict data at once</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dict</strong> (<em>dict</em>) – Dictionary of flux. Data in ‘value’, ‘stdev’, ‘lb’, ‘ub’ and ‘type’ fields are used.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">set_constraints_from_state_dict</span><span class="p">(</span><span class="n">flux_dict</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.set_experiment">
<span class="sig-name descname"><span class="pre">set_experiment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mdv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">carbon_sources</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">startidv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.set_experiment" title="Permalink to this definition">¶</a></dt>
<dd><p>Setter of an ‘experiment’ to metabolic model.</p>
<p>Here an ‘experiment’ indicated a set of a carbon source labeling pattern and a measured MDV data.</p>
<p>Parallel labeling experiment can be performed by setting multiple sets of ‘experiment’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – name of the experiment (unique)</p></li>
<li><p><strong>mdv</strong> (<em>instance</em>) – MDVdata instance including measured MDV data of target fragments.</p></li>
<li><p><strong>carbon_sources</strong> (<em>instance</em>) – Instance of carbon source object</p></li>
<li><p><strong>startidv</strong> (<em>array</em>) – array of idv as starting isotope distribution for INST</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">set_experiment</span><span class="p">(</span><span class="s1">&#39;ex1&#39;</span><span class="p">,</span> <span class="n">mdv1</span><span class="p">,</span> <span class="n">cs1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">set_experiment</span><span class="p">(</span><span class="s1">&#39;ex2&#39;</span><span class="p">,</span> <span class="n">mdv2</span><span class="p">,</span> <span class="n">cs2</span><span class="p">,</span> <span class="n">startidv</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.show_flux_balance">
<span class="sig-name descname"><span class="pre">show_flux_balance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metabolite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'csv'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.show_flux_balance" title="Permalink to this definition">¶</a></dt>
<dd><p>List of metabolic flux levels of reactions related to given metabolite.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> – Tuple of (“name”, dic of metabolic statet) [(‘name1’, state1),(‘name2’, state2),(‘name3’, state3),]</p></li>
<li><p><strong>metabolite</strong> – ID of metabolite of interest</p></li>
<li><p><strong>filename</strong> – Results are saved when file name is not “”.</p></li>
<li><p><strong>format</strong> – “csv” or “text”</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">show_metabolite_balance</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="s2">&quot;Fum&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">show_metabolite_balance</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="s2">&quot;Fum&quot;</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;metabolite_balance.csv&quot;</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s2">&quot;csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.show_results">
<span class="sig-name descname"><span class="pre">show_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'on'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'on'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mdv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'on'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'off'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkrss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'off'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'csv'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.show_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to output metabolic state data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>tuple</em>) – Tuple of (“name”, dic of metabolic statet) [(‘name1’, state1),(‘name2’, state2),(‘name3’, state3),]</p></li>
<li><p><strong>flux</strong> (<em>str</em>) – show flux data “on”/”off”</p></li>
<li><p><strong>rss</strong> (<em>check</em>) – show rss data “on”/”off”</p></li>
<li><p><strong>mdv</strong> (<em>str</em>) – show mdv data “on”/”off”</p></li>
<li><p><strong>pool_size</strong> (<em>str</em>) – show metabolite data “on”/”off”</p></li>
<li><p><strong>rss</strong> – show each RSS value “on”/”off”</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – Results are saved when file name is not “”/</p></li>
<li><p><strong>format</strong> (<em>str</em>) – “csv” or “text”</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">flux</span> <span class="o">=</span> <span class="s2">&quot;on&quot;</span><span class="p">,</span> <span class="n">rss</span> <span class="o">=</span> <span class="s2">&quot;on&quot;</span><span class="p">,</span> <span class="n">mdv</span> <span class="o">=</span> <span class="s2">&quot;on&quot;</span><span class="p">,</span> <span class="n">pool_size</span> <span class="o">=</span> <span class="s2">&quot;off&quot;</span><span class="p">,</span>  <span class="n">checkrss</span> <span class="o">=</span> <span class="s2">&quot;on&quot;</span><span class="p">)</span><span class="c1"># Output to console</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;show_results.csv&quot;</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s2">&quot;csv&quot;</span><span class="p">)</span><span class="c1"># Output to .csv file</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.show_results_in_map">
<span class="sig-name descname"><span class="pre">show_results_in_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapfilename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfilename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formattext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.1f'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.show_results_in_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to project metabolic state data into metabolic file (.GML).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flux</strong> (<em>dict</em>) – dict of metabolic state</p></li>
<li><p><strong>mapfilename</strong> (<em>str</em>) – name of blank GML file</p></li>
<li><p><strong>outputfilename</strong> (<em>str</em>) – name of uutput GML file</p></li>
<li><p><strong>format</strong> (<em>str</em>) – format string of “format” method of string</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">show_results_in_map</span><span class="p">(</span><span class="n">flux_opt1</span><span class="p">,</span> <span class="s2">&quot;Example_2_cancer_map_new.gml&quot;</span><span class="p">,</span> <span class="s2">&quot;Example_2_cancer_map_mapped.gml&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">show_results_in_map</span><span class="p">(</span><span class="n">flux_opt1</span><span class="p">,</span> <span class="s2">&quot;Example_2_cancer_map_new.gml&quot;</span><span class="p">,</span> <span class="s2">&quot;Example_2_cancer_map_mapped.gml&quot;</span><span class="p">,</span> <span class="n">formattext</span> <span class="o">=</span> <span class="s2">&quot;.2f&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfapy.metabolicmodel.MetabolicModel.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.metabolicmodel.MetabolicModel.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to generate stoichiometry matrix.</p>
<p>A metabolic model have to be updated when any types (fixed, free, fitting, pseudo) of reactions, metabolites, and reversible reactions are modified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>required.</strong> (<em>Not</em>) – </p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>reconstruct</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-mfapy.mfapyio">
<span id="mfapy-mfapyio-module"></span><h2>mfapy.mfapyio module<a class="headerlink" href="#module-mfapy.mfapyio" title="Permalink to this heading">¶</a></h2>
<p>mfapyio.py:I/O funtions for mfapy</p>
<p>This module includes functions to read model description files.</p>
<p>Following functions are available:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">load_metabolic_model_reactions</span>
<span class="n">load_metabolic_model_metabolites</span>
<span class="n">load_metabolic_model_reversibles</span>
<span class="n">load_metabolic_model_fragments</span>
<span class="n">load_metabolic_model</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reactions</span><span class="p">,</span> <span class="n">reversible</span><span class="p">,</span> <span class="n">metabolites</span><span class="p">,</span> <span class="n">target_fragments</span> <span class="o">=</span> <span class="n">mfapy</span><span class="o">.</span><span class="n">mfapyio</span><span class="o">.</span><span class="n">load_metabolic_model</span><span class="p">(</span><span class="s2">&quot;Explanation_1_13CMFA_toymodel_model.txt&quot;</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s2">&quot;text&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="id4">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Support other file formats</p></li>
</ul>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="mfapy.mfapyio.load_metabolic_model">
<span class="sig-prename descclassname"><span class="pre">mfapy.mfapyio.</span></span><span class="sig-name descname"><span class="pre">load_metabolic_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'text'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mfapy/mfapyio.html#load_metabolic_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfapy.mfapyio.load_metabolic_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to load metabolic model information from a text file</p>
<p>CAUTION: Now this function has no error checking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – metabolic model file</p></li>
<li><p><strong>format</strong> (<em>str</em>) – “text” (defalut, tab deliminated) or “csv”</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – “normal” (defalut) or “debug” (to show loaded metabolic file data)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>reactions (dict), Dictionary describing metabolite reactions</p></li>
<li><p>reversible (dict), Dictionary for defining reversible reactions</p></li>
<li><p>metabolites (dict), Dictionary including metabolite information</p></li>
<li><p>target_fragments (dict), Dictionary of target_fragments</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reactions</span><span class="p">,</span> <span class="n">reversible</span><span class="p">,</span> <span class="n">metabolites</span><span class="p">,</span> <span class="n">target_fragments</span> <span class="o">=</span> <span class="n">load_metabolic_model</span><span class="p">(</span><span class="s2">&quot;filename.txt&#39;)</span>
<span class="go"># The obtaind data (dictionaries) are directly used for generation of new Metabolic Model object</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MetabolicModel</span><span class="p">(</span><span class="n">reactions</span><span class="p">,</span> <span class="n">reversible</span><span class="p">,</span> <span class="n">metabolites</span><span class="p">,</span> <span class="n">target_fragments</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfapy.mfapyio.load_metabolic_model_fragments">
<span class="sig-prename descclassname"><span class="pre">mfapy.mfapyio.</span></span><span class="sig-name descname"><span class="pre">load_metabolic_model_fragments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'text'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mfapy/mfapyio.html#load_metabolic_model_fragments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfapy.mfapyio.load_metabolic_model_fragments" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to load mass fragment information from a metabolic model file with following format.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">Target_fragments</span>
<span class="n">Glue</span>    <span class="n">gcms</span>    <span class="n">Glu_1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span><span class="mi">5</span>   <span class="n">use</span>     <span class="n">C5H10N2O3</span>
<span class="n">Gluee</span>   <span class="n">gcms</span>    <span class="n">Glu_1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="o">+</span><span class="n">Glu_4</span><span class="p">:</span><span class="mi">5</span>       <span class="n">use</span>     <span class="n">C5H10N2O3</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – metabolic model file</p></li>
<li><p><strong>format</strong> (<em>str</em>) – “text” (defalut, tab deliminated) or “csv”</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – “normal” (defalut) or “debug” (to show loaded metabolic file data)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of target_fragments</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">target_fragments</span> <span class="o">=</span> <span class="n">load_metabolic_model_fragments</span><span class="p">(</span><span class="s1">&#39;filename.txt&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">target_fragments</span>
<span class="go">{&#39;Thr302&#39;: {&#39;atommap&#39;: &#39;Thr_12&#39;, &#39;use&#39;: &#39;no&#39;, &#39;type&#39;: &#39;gcms&#39;, &#39;order&#39;: 35, &#39;number&#39;: 3}, ...}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfapy.mfapyio.load_metabolic_model_metabolites">
<span class="sig-prename descclassname"><span class="pre">mfapy.mfapyio.</span></span><span class="sig-name descname"><span class="pre">load_metabolic_model_metabolites</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'text'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mfapy/mfapyio.html#load_metabolic_model_metabolites"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfapy.mfapyio.load_metabolic_model_metabolites" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to load Metabolite information from a file with following format.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">Metabolites</span>
<span class="n">CO2ex</span>   <span class="mi">1</span>       <span class="n">no</span>      <span class="n">no</span>      <span class="n">excreted</span>        <span class="p">(</span><span class="n">kegg</span><span class="p">:</span><span class="n">C00011</span><span class="p">)</span>   <span class="mf">0.0</span>     <span class="mi">300</span>
<span class="n">AcCoA</span>   <span class="mi">2</span>       <span class="n">no</span>      <span class="n">carbonsource</span>    <span class="n">no</span>      <span class="p">(</span><span class="n">kegg</span><span class="p">:</span><span class="n">C00024</span><span class="p">)</span>   <span class="mf">0.0</span>     <span class="mi">300</span>
<span class="n">OAC</span>     <span class="mi">4</span>       <span class="n">no</span>      <span class="n">no</span>      <span class="n">no</span>      <span class="p">(</span><span class="n">kegg</span><span class="p">:</span><span class="n">C00036</span><span class="p">)</span>   <span class="mf">0.0</span>     <span class="mi">300</span>
<span class="n">Cit</span>     <span class="mi">6</span>       <span class="n">no</span>      <span class="n">no</span>      <span class="n">no</span>      <span class="p">(</span><span class="n">kegg</span><span class="p">:</span><span class="n">C00158</span><span class="p">)</span>   <span class="mf">0.0</span>     <span class="mi">300</span>
<span class="n">AKG</span>     <span class="mi">5</span>       <span class="n">no</span>      <span class="n">no</span>      <span class="n">no</span>      <span class="p">(</span><span class="n">kegg</span><span class="p">:</span><span class="n">C00026</span><span class="p">)</span>   <span class="mf">0.0</span>     <span class="mi">300</span>
<span class="n">Suc</span>     <span class="mi">4</span>       <span class="n">symmetry</span>        <span class="n">no</span>      <span class="n">no</span>      <span class="p">(</span><span class="n">kegg</span><span class="p">:</span><span class="n">C00042</span><span class="p">)</span>   <span class="mf">0.0</span>     <span class="mi">300</span>
<span class="n">Fum</span>     <span class="mi">4</span>       <span class="n">symmetry</span>        <span class="n">no</span>      <span class="n">no</span>      <span class="p">(</span><span class="n">kegg</span><span class="p">:</span><span class="n">C00122</span><span class="p">)</span>   <span class="mf">0.0</span>     <span class="mi">300</span>
<span class="n">Glu</span>     <span class="mi">5</span>       <span class="n">no</span>      <span class="n">no</span>      <span class="n">no</span>      <span class="p">(</span><span class="n">kegg</span><span class="p">:</span><span class="n">C00025</span><span class="p">)</span>   <span class="mf">0.0</span>     <span class="mi">300</span>
<span class="n">Asp</span>     <span class="mi">4</span>       <span class="n">no</span>      <span class="n">carbonsource</span>    <span class="n">no</span>      <span class="p">(</span><span class="n">kegg</span><span class="p">:</span><span class="n">C00049</span><span class="p">)</span>   <span class="mf">0.0</span>     <span class="mi">300</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – metabolic model file</p></li>
<li><p><strong>format</strong> (<em>str</em>) – “text” (defalut, tab deliminated) or “csv”</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – “normal” (defalut) or “debug” (to show loaded metabolic file data)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary including metabolite information</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">metabolites</span> <span class="o">=</span> <span class="n">load_metabolic_model_metabolites</span><span class="p">(</span><span class="s1">&#39;filename.txt&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">metabolites</span>
<span class="go">{&#39;GLUEX&#39;: {&#39;excreted&#39;: &#39;no&#39;, &#39;carbonsource&#39;: &#39;carbonsource&#39;, &#39;C_number&#39;: 5, &#39;symmetry&#39;: &#39;no&#39;, &#39;order&#39;: 4}, ...}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfapy.mfapyio.load_metabolic_model_reactions">
<span class="sig-prename descclassname"><span class="pre">mfapy.mfapyio.</span></span><span class="sig-name descname"><span class="pre">load_metabolic_model_reactions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'text'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mfapy/mfapyio.html#load_metabolic_model_reactions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfapy.mfapyio.load_metabolic_model_reactions" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to load metabolic reaction information from a text or CSV file with following format.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">Reactions</span>
<span class="n">v1</span>      <span class="n">AcCoA</span> <span class="o">+</span> <span class="n">OAC</span> <span class="o">--&gt;</span> <span class="n">Cit</span>     <span class="n">AcCoA</span> <span class="o">+</span> <span class="n">OAC</span> <span class="o">--&gt;</span> <span class="n">Cit</span>     <span class="n">AB</span> <span class="o">+</span> <span class="n">CDEF</span> <span class="o">--&gt;</span> <span class="n">FEDBAC</span>    <span class="p">(</span><span class="n">kegg</span><span class="p">:</span><span class="n">R00351</span><span class="p">)</span>   <span class="mf">0.0</span>     <span class="mi">300</span>
<span class="n">v2</span>      <span class="n">Cit</span> <span class="o">--&gt;</span> <span class="n">AKG</span> <span class="o">+</span> <span class="n">CO2ex</span>     <span class="n">Cit</span> <span class="o">--&gt;</span> <span class="n">AKG</span> <span class="o">+</span> <span class="n">CO2ex</span>     <span class="n">ABCDEF</span> <span class="o">--&gt;</span> <span class="n">ABCDE</span> <span class="o">+</span> <span class="n">F</span>    <span class="p">(</span><span class="n">kegg</span><span class="p">:</span><span class="n">R00709</span><span class="p">)</span>   <span class="mf">0.0</span>     <span class="mi">300</span>
<span class="n">v3</span>      <span class="n">AKG</span> <span class="o">--&gt;</span> <span class="n">Glu</span>     <span class="n">AKG</span> <span class="o">--&gt;</span> <span class="n">Glu</span>     <span class="n">ABCDE</span> <span class="o">--&gt;</span> <span class="n">ABCDE</span>         <span class="p">(</span><span class="n">kegg</span><span class="p">:</span><span class="n">R00243</span><span class="p">)</span>   <span class="mf">0.0</span>     <span class="mi">300</span>
<span class="n">v4</span>      <span class="n">AKG</span> <span class="o">--&gt;</span> <span class="n">Suc</span> <span class="o">+</span> <span class="n">CO2ex</span>     <span class="n">AKG</span> <span class="o">--&gt;</span> <span class="n">Suc</span> <span class="o">+</span> <span class="n">CO2ex</span>     <span class="n">ABCDE</span> <span class="o">--&gt;</span> <span class="n">BCDE</span> <span class="o">+</span> <span class="n">A</span>      <span class="p">(</span><span class="n">kegg</span><span class="p">:</span><span class="n">R01197</span><span class="p">)</span>   <span class="mf">0.0</span>     <span class="mi">300</span>
<span class="n">v5</span>      <span class="n">Suc</span> <span class="o">--&gt;</span> <span class="n">Fum</span>     <span class="n">Suc</span> <span class="o">--&gt;</span> <span class="n">Fum</span>     <span class="n">ABCD</span> <span class="o">--&gt;</span> <span class="n">ABCD</span>   <span class="p">(</span><span class="n">kegg</span><span class="p">:</span><span class="n">R02164</span><span class="p">)</span>   <span class="mf">0.0</span>     <span class="mi">300</span>
<span class="n">v6</span>      <span class="n">Fum</span> <span class="o">--&gt;</span> <span class="n">OAC</span>     <span class="n">Fum</span> <span class="o">--&gt;</span> <span class="n">OAC</span>     <span class="n">ABCD</span> <span class="o">--&gt;</span> <span class="n">ABCD</span>   <span class="p">(</span><span class="n">kegg</span><span class="p">:</span><span class="n">R01082</span><span class="p">)</span>   <span class="mf">0.0</span>     <span class="mi">300</span>
<span class="n">v7</span>      <span class="n">OAC</span> <span class="o">--&gt;</span> <span class="n">Fum</span>     <span class="n">OAC</span> <span class="o">--&gt;</span> <span class="n">Fum</span>     <span class="n">ABCD</span> <span class="o">--&gt;</span> <span class="n">ABCD</span>   <span class="p">(</span><span class="n">kegg</span><span class="p">:</span><span class="n">R01082</span><span class="p">)</span>   <span class="mf">0.0</span>     <span class="mi">300</span>
<span class="n">v8</span>      <span class="n">Asp</span> <span class="o">--&gt;</span> <span class="n">OAC</span>     <span class="n">Asp</span> <span class="o">--&gt;</span> <span class="n">OAC</span>     <span class="n">ABCD</span> <span class="o">--&gt;</span> <span class="n">ABCD</span>   <span class="p">(</span><span class="n">kegg</span><span class="p">:</span><span class="n">R00355</span><span class="p">)</span>   <span class="mf">0.0</span>     <span class="mi">300</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – metabolic model file name</p></li>
<li><p><strong>format</strong> (<em>str</em>) – “text” (defalut, tab deliminated) or “csv”</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – “normal” (defalut) or “debug” (to show loaded metabolic file data).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary describing metabolite reactions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reactions</span> <span class="o">=</span> <span class="n">load_metabolic_model_reaction</span><span class="p">(</span><span class="s1">&#39;filename.txt&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">reactions</span>
<span class="go">{&#39;r4&#39;: {&#39;atommap&#39;: &#39;AB+CDEF--&gt;FEDBAC&#39;, &#39;reaction&#39;: &#39;ACCOA+OAA--&gt;ICI&#39;, &#39;use&#39;: &#39;use&#39;, &#39;lb&#39;: 0.1, &#39;flux_value&#39;: 0.0, &#39;reversible&#39;: &#39;no&#39;, &#39;flux_var&#39;: 1.0, &#39;type&#39;: &#39;free&#39;, &#39;order&#39;: 3, &#39;ub&#39;: 300.0},...}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfapy.mfapyio.load_metabolic_model_reversibles">
<span class="sig-prename descclassname"><span class="pre">mfapy.mfapyio.</span></span><span class="sig-name descname"><span class="pre">load_metabolic_model_reversibles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'text'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mfapy/mfapyio.html#load_metabolic_model_reversibles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfapy.mfapyio.load_metabolic_model_reversibles" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to load definitions of reversible reactions from a metabolic model file with following format.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">Reversible_reactions</span>
<span class="n">FUM</span>     <span class="n">v6</span>      <span class="n">v7</span>      <span class="p">(</span><span class="n">kegg</span><span class="p">:</span><span class="n">R01082</span><span class="p">)</span>   <span class="mf">0.0</span>     <span class="mi">300</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – metabolic model file</p></li>
<li><p><strong>format</strong> (<em>str</em>) – “text” (defalut, tab deliminated) or “csv”</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – “normal” (defalut) or “debug” (to show loaded metabolic file data)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary for defining reversible reactions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reversible</span> <span class="o">=</span> <span class="n">load_metabolic_model_reversibles</span><span class="p">(</span><span class="s1">&#39;filename.txt&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">reversible</span>
<span class="go">{&#39;MDH&#39;: {&#39;flux_value&#39;: 0.0, &#39;reverse&#39;: &#39;r27&#39;, &#39;flux_var&#39;: 1.0, &#39;forward&#39;: &#39;r26&#39;, &#39;type&#39;: &#39;free&#39;, &#39;order&#39;: 6}, ...}</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-mfapy.optimize">
<span id="mfapy-optimize-module"></span><h2>mfapy.optimize module<a class="headerlink" href="#module-mfapy.optimize" title="Permalink to this heading">¶</a></h2>
<p>optimize.py:low level optimizer functions used in mfapy.</p>
<p>These functions were separated from model instance for the parallel execution.</p>
<div class="admonition-todo admonition" id="id5">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Cleaning-up and support other optimizers</p></li>
</ul>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="mfapy.optimize.calc_MDV_from_flux">
<span class="sig-prename descclassname"><span class="pre">mfapy.optimize.</span></span><span class="sig-name descname"><span class="pre">calc_MDV_from_flux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tmp_r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_fragments</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mdv_carbon_sources</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timepoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0temp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.optimize.calc_MDV_from_flux" title="Permalink to this definition">¶</a></dt>
<dd><p>Low level function to calculate mdv vector and mdv hash from metabolic flux and carbon source MDV using calmdv.</p>
<p>This funcition is called from mfapy.metabolicmodel.show_results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tmp_r</strong> (<em>array</em>) – list of metabolic state data (tmp_r = numpy.dot(matrixinv, Rm_temp)</p></li>
<li><p><strong>target_fragments</strong> (<em>array</em>) – list of targed mdvs for MDV calclation, model.target_fragments.keys()</p></li>
<li><p><strong>mdv_carbon_sources</strong> (<em>dict</em>) – dict of mdv_carbon_sources in model.experiments[ex_id][‘mdv_carbon_sources’]</p></li>
<li><p><strong>func</strong> (<em>dict</em>) – Dict of functions for MDV calclation in model.func</p></li>
<li><p><strong>timepoint</strong> (<em>array</em>) – For INST mode only. timepoints for MDV comparison in model.experiments[ex_id][‘timepoint’]
When the length of timepoint array &gt;= 1, INST mode is used.</p></li>
<li><p><strong>y0temp</strong> (<em>dict</em>) – Start IDV state for INST mode</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul>
<li><p>mdv (array) list of MDV data</p>
<blockquote>
<div><ul class="simple">
<li><p>mdv_hash (dict) dict of MDV data</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<dl class="simple">
<dt>INST-MFA mode:</dt><dd><ul class="simple">
<li><p>mdv (array) array of mdv at each time point</p></li>
<li><p>mdv_hash (array) array of mdv_hash at each time point</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>13C-MFA mode</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mdv_exp</span><span class="p">,</span> <span class="n">mdv_hash</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">calc_MDV_from_flux</span><span class="p">(</span><span class="n">tmp_r</span><span class="p">,</span> <span class="n">target_fragments_temp</span><span class="p">,</span> <span class="n">mdv_carbon_sources_temp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>mfapy.metabolicmodel.show_results</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfapy.optimize.calc_MDV_residue">
<span class="sig-prename descclassname"><span class="pre">mfapy.optimize.</span></span><span class="sig-name descname"><span class="pre">calc_MDV_residue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.optimize.calc_MDV_residue" title="Permalink to this definition">¶</a></dt>
<dd><p>Low level function for residual sum of square calculation from mfapy.metabolicmodel.MetaboliModel.calc_rss</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array</em>) – vector of independent flux.</p></li>
<li><p><strong>*args</strong> (<em>array</em>) – list of parameters.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – dic of parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>RSS + Penalty score (When out side of the lower and upper boundaries)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>fit_r_mdv_scipy</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfapy.optimize.calc_MDV_residue_nlopt">
<span class="sig-prename descclassname"><span class="pre">mfapy.optimize.</span></span><span class="sig-name descname"><span class="pre">calc_MDV_residue_nlopt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.optimize.calc_MDV_residue_nlopt" title="Permalink to this definition">¶</a></dt>
<dd><p>Low level function for residual sum of square calculation for model fitting using nlopt.nlopt</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array</em>) – vector of independent flux.</p></li>
<li><p><strong>*args</strong> (<em>array</em>) – list of parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>RSS + Penalty score (When out side of the lower and upper boundaries)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>fit_r_mdv_scipy</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfapy.optimize.calc_MDV_residue_scipy">
<span class="sig-prename descclassname"><span class="pre">mfapy.optimize.</span></span><span class="sig-name descname"><span class="pre">calc_MDV_residue_scipy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.optimize.calc_MDV_residue_scipy" title="Permalink to this definition">¶</a></dt>
<dd><p>Low level function for residual sum of square calculation for model fitting using scipy.optimize.minimize</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array</em>) – vector of independent flux.</p></li>
<li><p><strong>*args</strong> (<em>array</em>) – list of parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>RSS + Penalty score (When out side of the lower and upper boundaries)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>fit_r_mdv_scipy</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfapy.optimize.calc_protrude_nlopt">
<span class="sig-prename descclassname"><span class="pre">mfapy.optimize.</span></span><span class="sig-name descname"><span class="pre">calc_protrude_nlopt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">independent_flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.optimize.calc_protrude_nlopt" title="Permalink to this definition">¶</a></dt>
<dd><p>Objective function used in initializing_Rm_fitting (nlpot)</p>
<p>Calc penalty score of metabolic state out side of the feasible space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>independent_flux</strong> (<em>array</em>) – vector of independent flux</p></li>
<li><p><strong>grad</strong> – not used</p></li>
<li><p><strong>*args</strong> (<em>array</em>) – list of parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Penalty score</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>initializing_Rm_fitting</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfapy.optimize.calc_protrude_scipy">
<span class="sig-prename descclassname"><span class="pre">mfapy.optimize.</span></span><span class="sig-name descname"><span class="pre">calc_protrude_scipy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">independent_flux</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.optimize.calc_protrude_scipy" title="Permalink to this definition">¶</a></dt>
<dd><p>Objective function used in initializing_Rm_fitting (SLSQP)</p>
<p>This function calculates penalty score of metabolic state out side of the feasible space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>independent_flux</strong> (<em>array</em>) – vector of independent flux</p></li>
<li><p><strong>*args</strong> (<em>list</em>) – list of parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Penalty score</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>initializing_Rm_fitting</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfapy.optimize.fit_r_mdv_deep">
<span class="sig-prename descclassname"><span class="pre">mfapy.optimize.</span></span><span class="sig-name descname"><span class="pre">fit_r_mdv_deep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">configure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">experiments</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numbers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrixinv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.optimize.fit_r_mdv_deep" title="Permalink to this definition">¶</a></dt>
<dd><p>Low level function for model fitting by iterative fittings.</p>
<ul class="simple">
<li><p>1st iteration:  GN_CRS2_LM (global optimizer)</p></li>
<li><p>2n th iterations:  SLSQP (local)</p></li>
<li><p>2n + 1 th iterations:  LN_SBPLX (local)</p></li>
</ul>
<p>This combination is empirically best</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>configures</strong> (<em>dict</em>) – “model.configures” including various configulatoins of the model.</p></li>
<li><p><strong>experiments</strong> (<em>dict</em>) – “model.experiments” including experiments defined in the model.</p></li>
<li><p><strong>numbers</strong> (<em>dict</em>) – “model.numbers” including various numbers of the model.</p></li>
<li><p><strong>vectors</strong> (<em>dict</em>) – “model.vector” including various vectors of the model.</p></li>
<li><p><strong>matrixinv</strong> (<em>2d array</em>) – “model.matrixinv” is a inversed matrix for the flux calculation.</p></li>
<li><p><strong>func</strong> (<em>dict</em>) – Dict of functions for MDV calclation in model.func</p></li>
<li><p><strong>flux</strong> (<em>dict</em>) – Dictionary of initial metabolic state.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (str) finishing condition</p></li>
<li><p>kai (float) Residual sum of square of fitted metabolic state</p></li>
<li><p>opt_flux (array) list of fitted metabolix state</p></li>
<li><p>Rm_ind_sol (array) list of fitted independent flux</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">state</span><span class="p">,</span> <span class="n">kai</span><span class="p">,</span> <span class="n">opt_flux</span><span class="p">,</span> <span class="n">Rm_ind_sol</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fit_r_deep</span><span class="p">(</span><span class="n">configure</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiments</span><span class="p">,</span> <span class="n">numbers</span><span class="p">,</span> <span class="n">vectors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrixinv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">flux</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>optimize.fit_r_nlopt
optimize.fit_r_scipy</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfapy.optimize.fit_r_mdv_nlopt">
<span class="sig-prename descclassname"><span class="pre">mfapy.optimize.</span></span><span class="sig-name descname"><span class="pre">fit_r_mdv_nlopt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">configure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">experiments</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numbers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrixinv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LN_PRAXIS'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.optimize.fit_r_mdv_nlopt" title="Permalink to this definition">¶</a></dt>
<dd><p>Low level function for model fitting using nlopt.opt</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>configures</strong> (<em>dict</em>) – “model.configures” including various configulatoins of the model.</p></li>
<li><p><strong>experiments</strong> (<em>dict</em>) – “model.experiments” including experiments defined in the model.</p></li>
<li><p><strong>numbers</strong> (<em>dict</em>) – “model.numbers” including various numbers of the model.</p></li>
<li><p><strong>vectors</strong> (<em>dict</em>) – “model.vector” including various vectors of the model.</p></li>
<li><p><strong>matrixinv</strong> (<em>2d array</em>) – “model.matrixinv” is a inversed matrix for the flux calculation.</p></li>
<li><p><strong>func</strong> (<em>dict</em>) – Dict of functions for MDV calclation in model.func</p></li>
<li><p><strong>flux</strong> (<em>dict</em>) – Dictionary of initial metabolic state.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – “LN_COBYLA”, “LN_BOBYQA”, “LN_NEWUOA”, “LN_PRAXIS”, “LN_SBPLX”, “LN_NELDERMEAD”, “GN_DIRECT_L”, “GN_CRS2_LM”,”GN_ESCH”</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (str) finishing condition</p></li>
<li><p>kai (float) Residual sum of square of fitted metabolic state</p></li>
<li><p>opt_flux (array) list of fitted metabolix state</p></li>
<li><p>Rm_ind_sol (array) list of fitted independent flux</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">state</span><span class="p">,</span> <span class="n">kai</span><span class="p">,</span> <span class="n">opt_flux</span><span class="p">,</span> <span class="n">Rm_ind_sol</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fit_r_mdv_nlopt</span><span class="p">(</span><span class="n">configure</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiments</span><span class="p">,</span> <span class="n">numbers</span><span class="p">,</span> <span class="n">vectors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrixinv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;LN_PRAXIS&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>calc_MDV_residue_nlopt</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfapy.optimize.fit_r_mdv_scipy">
<span class="sig-prename descclassname"><span class="pre">mfapy.optimize.</span></span><span class="sig-name descname"><span class="pre">fit_r_mdv_scipy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">configure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">experiments</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numbers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrixinv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SLSQP'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.optimize.fit_r_mdv_scipy" title="Permalink to this definition">¶</a></dt>
<dd><p>Low level function for model fitting using scipy.optimize.minimize</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>configures</strong> (<em>dict</em>) – “model.configures” including various configulatoins of the model.</p></li>
<li><p><strong>experiments</strong> (<em>dict</em>) – “model.experiments” including experiments defined in the model.</p></li>
<li><p><strong>numbers</strong> (<em>dict</em>) – “model.numbers” including various numbers of the model.</p></li>
<li><p><strong>vectors</strong> (<em>dict</em>) – “model.vector” including various vectors of the model.</p></li>
<li><p><strong>matrixinv</strong> (<em>2d array</em>) – “model.matrixinv” is a inversed matrix for the flux calculation.</p></li>
<li><p><strong>func</strong> (<em>dict</em>) – Dict of functions for MDV calclation in model.func</p></li>
<li><p><strong>flux</strong> (<em>dict</em>) – Dictionary of initial metabolic state.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – “SLSQP” and “COBYLA” are available</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (str) finishing condition</p></li>
<li><p>kai (float) Residual sum of square of fitted metabolic state</p></li>
<li><p>opt_flux (array) list of fitted metabolix state</p></li>
<li><p>Rm_ind_sol (array) list of fitted independent flux</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">state</span><span class="p">,</span> <span class="n">kai</span><span class="p">,</span> <span class="n">opt_flux</span><span class="p">,</span> <span class="n">Rm_ind_sol</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fit_r_mdv_scipy</span><span class="p">(</span><span class="n">configure</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiments</span><span class="p">,</span> <span class="n">numbers</span><span class="p">,</span> <span class="n">vectors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrixinv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;SLSQP&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>calc_MDV_residue_scipy</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfapy.optimize.initializing_Rm_fitting">
<span class="sig-prename descclassname"><span class="pre">mfapy.optimize.</span></span><span class="sig-name descname"><span class="pre">initializing_Rm_fitting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">numbers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrixinv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_search_iteration_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fitting'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mfapy.optimize.initializing_Rm_fitting" title="Permalink to this definition">¶</a></dt>
<dd><p>Funcition to generate randomized initial flux dixtribution using scipy.optimize.minimize SLSQP</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>numbers</strong> (<em>dict</em>) – “model.numbers” including various number related data of the model.</p></li>
<li><p><strong>vectors</strong> (<em>dict</em>) – “model.vector” including various vector related data of the model.</p></li>
<li><p><strong>matrixinv</strong> (<em>numpy 2d array</em>) – “model.matrixinv” is a inversed matrix of stoichiometry matrix for flux calculation.</p></li>
<li><p><strong>template</strong> (<em>dict</em>) – Dictionary of metabolic state. When template is available, metabolic state most similar to the template is generated. The function is used in the grid search.</p></li>
<li><p><strong>initial_search_iteration_max</strong> (<em>int</em>) – “configure[“initial_search_iteration_max”]”. Maximal number of interations (steps) allowed in each task to find feasible initial metabolic flux distribution.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – “fitting” is only available.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tmp_r (list) list of metabolic state data (tmp_r = numpy.dot(matrixinv, Rm_temp)</p>
<p>Rm_temp (list) metabolic state vector</p>
<p>Rm_ind (list) independent flux vector</p>
<p>state (str) State of finishing condition “Failed”/”Determined”</p>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_r</span><span class="p">,</span> <span class="n">Rm_temp</span><span class="p">,</span> <span class="n">Rm_ind</span><span class="p">,</span> <span class="n">state</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">initializing_Rm_fitting</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">vectors</span><span class="p">,</span> <span class="n">matrixinv</span><span class="p">,</span> <span class="n">template</span> <span class="p">,</span><span class="n">initial_search_iteration_max</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>calc_protrude_scipy</p>
</div>
</dd></dl>

</section>
<section id="module-mfapy">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-mfapy" title="Permalink to this heading">¶</a></h2>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">mfapy</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">mfapy package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mfapy.carbonsource">mfapy.carbonsource module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mfapy.mdv">mfapy.mdv module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mfapy.metabolicmodel">mfapy.metabolicmodel module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mfapy.mfapyio">mfapy.mfapyio module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mfapy.optimize">mfapy.optimize module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mfapy">Module contents</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Welcome to mfapy’s documentation!</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2024, Author.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/mfapy.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>